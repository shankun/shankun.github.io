<!doctype html><html lang=zh_CN><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="light dark" name=color-scheme><title>å‡½æ•°å¼ç¼–ç¨‹æŒ‡å—ä¸­æ–‡ç‰ˆç¬¬8ç« </title><link href=https://shankun.github.io/img/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://shankun.github.io/img/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=https://shankun.github.io/img/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><style>body{--primary-color:#5871a2;--primary-pale-color:#5871a210;--text-color:#3c4043;--text-pale-color:#94969f;--bg-color:#fff;--highlight-mark-color:#5f75b035;--callout-note-color:#5871a2;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460;--main-font:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--homepage-max-width:768px;--main-max-width:768px;--avatar-size:60px;--icon-size:20px;--homepage-font-size:16px;--homepage-line-height:1.75;--paragraph-font-size:16px;--paragraph-line-height:1.75;--aside-font-size:15px;--img-border-radius:0;--callout-border-radius:0;--detail-border-radius:0;--dark-mode-img-brightness:.75;--dark-mode-chart-brightness:.75;--inline-code-border-radius:2px;--inline-code-bg-color:var(--primary-pale-color);--block-code-border-radius:0;--block-code-border-color:var(--primary-color);--detail-border-color:var(--primary-color);--homepage-bg-image:url(https://shankun.github.io/img/greenBamboo.jpg)}body.dark{--primary-color:#5d77ac;--primary-pale-color:#5d77ac20;--text-color:#9197a5;--text-pale-color:#747983;--bg-color:#202124;--highlight-mark-color:#5f75b035;--callout-note-color:#5d77ac;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460}</style><link href=https://shankun.github.io/main.css rel=stylesheet><link href=https://shankun.github.io/hl-light.css id=hl rel=stylesheet><link crossorigin href=https://fastly.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV rel=stylesheet><script crossorigin defer integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 src=https://fastly.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js></script><script crossorigin defer integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 src=https://fastly.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false},{left:'\\(',right:'\\)',display:false},{left:'\\[',right:'\\]',display:true}],throwOnError:false})})</script><body class=post><script>const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = https://shankun.github.io/hl-dark.css;
    }</script><header class=blur><div id=header-wrapper><nav><a class=instant href=https://shankun.github.io>æ¯ä¸€å¤©éƒ½æ˜¯ç¦»åˆ«</a><button aria-label="toggle expand" class=separator id=toggler>ğŸš€</button><span class="wrap left fold">{</span><a class=instant href=https://shankun.github.io/posts>articles</a><span class="wrap-separator fold">,</span><a class="instant fold" href=https://shankun.github.io/projects>projects</a><span class="wrap right fold">} ;</span></nav><div id=btns><button aria-label="theme switch" data-moon-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>' data-sun-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>' id=theme-toggle><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill=currentColor></path></svg></button><button aria-label="table of content" id=toc-toggle><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M3 4H21V6H3V4ZM3 11H15V13H3V11ZM3 18H21V20H3V18Z" fill=currentColor></path></svg></button></div></div></header><div id=wrapper><div id=blank></div><aside><nav><ul><li><a class=h2 href=#te-bai-hui>ç‰¹ç™¾æƒ </a> <ul><li><a class=h3 href=#qiang-da-de-rong-qi>å¼ºå¤§çš„å®¹å™¨</a><li><a class=h3 href=#di-yi-ge-functor>ç¬¬ä¸€ä¸ª functor</a><li><a class=h3 href=#xie-ding-e-de-maybe>è–›å®šè°”çš„ Maybe</a><li><a class=h3 href=#yong-li>ç”¨ä¾‹</a><li><a class=h3 href=#shi-fang-rong-qi-li-de-zhi>é‡Šæ”¾å®¹å™¨é‡Œçš„å€¼</a><li><a class=h3 href=#chun-cuo-wu-chu-li>â€œçº¯â€é”™è¯¯å¤„ç†</a><li><a class=h3 href=#wang-lao-xian-sheng-you-zuo-yong>ç‹è€å…ˆç”Ÿæœ‰ä½œç”¨...</a><li><a class=h3 href=#yi-bu-ren-wu>å¼‚æ­¥ä»»åŠ¡</a><li><a class=h3 href=#yi-dian-li-lun>ä¸€ç‚¹ç†è®º</a><li><a class=h3 href=#zong-jie>æ€»ç»“</a><li><a class=h3 href=#lian-xi>ç»ƒä¹ </a></ul></ul></nav><button aria-label="back to top" id=back-to-top><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z" fill=currentColor></path></svg></button></aside><main><div><div data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' id=copy-cfg style=display:none></div><article data-backlink-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M9.41421 8L18.0208 16.6066L16.6066 18.0208L8 9.41421V17H6V6H17V8H9.41421Z" fill="currentColor"></path></svg>' class=prose><h1>å‡½æ•°å¼ç¼–ç¨‹æŒ‡å—ä¸­æ–‡ç‰ˆç¬¬8ç« </h1><div id=post-info><div id=date><span id=publish>2023-11-21</span></div><div id=tags><a class=instant href=https://shankun.github.io/tags/programming><span>#</span>programming</a><a class=instant href=https://shankun.github.io/tags/javascript><span>#</span>javascript</a></div></div><p><a rel="nofollow noreferrer" href=https://mostly-adequate.gitbook.io/mostly-adequate-guide/ch08>åŸæ–‡é“¾æ¥</a> â€ƒâ€ƒ <a href=../mostly-adequate-guide/#mu-lu>è¿”å›ç›®å½•</a><h1 id=te-bai-hui>ç‰¹ç™¾æƒ <a aria-label="Anchor link for: te-bai-hui" class=zola-anchor href=#te-bai-hui style=visibility:hidden>#</a></h1><p>ï¼ˆè¯‘è€…æ³¨ï¼šç‰¹ç™¾æƒ æ˜¯ç¾å›½å®¶å±…ç”¨å“å“ç‰Œï¼Œä»£è¡¨äº§å“æ˜¯å¡‘æ–™å®¹å™¨ã€‚ï¼‰<h2 id=qiang-da-de-rong-qi>å¼ºå¤§çš„å®¹å™¨<a aria-label="Anchor link for: qiang-da-de-rong-qi" class=zola-anchor href=#qiang-da-de-rong-qi style=visibility:hidden>#</a></h2><figure><img alt=http://blog.dwinegar.com/2011/06/another-jar.html src=https://shankun.github.io/img/jar.jpg></figure><p>æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä¹¦å†™å‡½æ•°å¼çš„ç¨‹åºäº†ï¼Œå³é€šè¿‡ç®¡é“æŠŠæ•°æ®åœ¨ä¸€ç³»åˆ—çº¯å‡½æ•°é—´ä¼ é€’çš„ç¨‹åºã€‚æˆ‘ä»¬ä¹ŸçŸ¥é“äº†ï¼Œè¿™äº›ç¨‹åºå°±æ˜¯å£°æ˜å¼çš„è¡Œä¸ºè§„èŒƒã€‚ä½†æ˜¯ï¼Œæ§åˆ¶æµï¼ˆcontrol flowï¼‰ã€å¼‚å¸¸å¤„ç†ï¼ˆerror handlingï¼‰ã€å¼‚æ­¥æ“ä½œï¼ˆasynchronous actionsï¼‰å’ŒçŠ¶æ€ï¼ˆstateï¼‰å‘¢ï¼Ÿè¿˜æœ‰æ›´æ£˜æ‰‹çš„ä½œç”¨ï¼ˆeffectsï¼‰å‘¢ï¼Ÿæœ¬ç« å°†å¯¹ä¸Šè¿°è¿™äº›æŠ½è±¡æ¦‚å¿µèµ–ä»¥å»ºç«‹çš„åŸºç¡€ä½œä¸€ç•ªæ¢ç©¶ã€‚<p>é¦–å…ˆæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼ˆcontainerï¼‰ã€‚è¿™ä¸ªå®¹å™¨å¿…é¡»èƒ½å¤Ÿè£…è½½ä»»æ„ç±»å‹çš„å€¼ï¼›å¦åˆ™çš„è¯ï¼Œåƒåªèƒ½è£…æœ¨è–¯å¸ƒä¸çš„å¯†å°å¡‘æ–™è¢‹æ˜¯æ²¡ä»€ä¹ˆç”¨çš„ã€‚è¿™ä¸ªå®¹å™¨å°†ä¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æˆ‘ä»¬ä¸ä¼šä¸ºå®ƒæ·»åŠ é¢å‘å¯¹è±¡è§‚å¿µä¸‹çš„å±æ€§å’Œæ–¹æ³•ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒå½“ä½œä¸€ä¸ªç™¾å®ç®±â€”â€”ä¸€ä¸ªå­˜æ”¾å®è´µçš„æ•°æ®çš„ç‰¹æ®Šç›’å­ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">Container</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Container</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>è¿™æ˜¯æœ¬ä¹¦çš„ç¬¬ä¸€ä¸ªå®¹å™¨ï¼Œæˆ‘ä»¬è´´å¿ƒåœ°æŠŠå®ƒå‘½åä¸º <code>Container</code>ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ <code>Container.of</code> ä½œä¸ºæ„é€ å™¨ï¼ˆconstructorï¼‰ï¼Œè¿™æ ·å°±ä¸ç”¨åˆ°å¤„å»å†™ç³Ÿç³•çš„ <code>new</code> å…³é”®å­—äº†ï¼Œéå¸¸çœå¿ƒã€‚å®é™…ä¸Šä¸èƒ½è¿™ä¹ˆç®€å•åœ°çœ‹å¾… <code>of</code> å‡½æ•°ï¼Œä½†æš‚æ—¶å…ˆè®¤ä¸ºå®ƒæ˜¯æŠŠå€¼æ”¾åˆ°å®¹å™¨é‡Œçš„ä¸€ç§æ–¹å¼ã€‚<p>æˆ‘ä»¬æ¥æ£€éªŒä¸‹è¿™ä¸ªå´­æ–°çš„ç›’å­ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">3</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(3)</span>


<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>hotdogs<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container("hotdogs")</span>


<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">name</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>yoda<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(Container({name: "yoda" }))</span>
</span></code></pre><p>å¦‚æœç”¨çš„æ˜¯ nodeï¼Œé‚£ä¹ˆä½ ä¼šçœ‹åˆ°æ‰“å°å‡ºæ¥çš„æ˜¯ <code>{__value: x}</code>ï¼Œè€Œä¸æ˜¯å®é™…å€¼ <code>Container(x)</code>ï¼›Chrome æ‰“å°å‡ºæ¥çš„æ˜¯æ­£ç¡®çš„ã€‚ä¸è¿‡è¿™å¹¶ä¸é‡è¦ï¼Œåªè¦ä½ ç†è§£ <code>Container</code> æ˜¯ä»€ä¹ˆæ ·çš„å°±è¡Œäº†ã€‚æœ‰äº›ç¯å¢ƒä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥é‡å†™ <code>inspect</code> æ–¹æ³•ï¼Œä½†æˆ‘ä»¬ä¸æ‰“ç®—æ¶‰åŠè¿™æ–¹é¢çš„çŸ¥è¯†ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œå‡ºäºæ•™å­¦å’Œç¾å­¦ä¸Šçš„è€ƒè™‘ï¼Œæˆ‘ä»¬å°†æŠŠæ¦‚å¿µæ€§çš„è¾“å‡ºéƒ½å†™æˆå¥½åƒ <code>inspect</code> è¢«é‡å†™äº†çš„æ ·å­ï¼Œå› ä¸ºè¿™æ ·å†™çš„æ•™è‚²æ„ä¹‰å°†è¿œè¿œå¤§äº <code>{__value: x}</code>ã€‚<p>åœ¨ç»§ç»­åé¢çš„å†…å®¹ä¹‹å‰ï¼Œå…ˆæ¾„æ¸…å‡ ç‚¹ï¼š<ul><li><code>Container</code> æ˜¯ä¸ªåªæœ‰ä¸€ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å°½ç®¡å®¹å™¨å¯ä»¥æœ‰ä¸æ­¢ä¸€ä¸ªçš„å±æ€§ï¼Œä½†å¤§å¤šæ•°å®¹å™¨è¿˜æ˜¯åªæœ‰ä¸€ä¸ªã€‚æˆ‘ä»¬å¾ˆéšæ„åœ°æŠŠ <code>Container</code> çš„è¿™ä¸ªå±æ€§å‘½åä¸º <code>__value</code>ã€‚<li><code>__value</code> ä¸èƒ½æ˜¯æŸä¸ªç‰¹å®šçš„ç±»å‹ï¼Œä¸ç„¶ <code>Container</code> å°±å¯¹ä¸èµ·å®ƒè¿™ä¸ªåå­—äº†ã€‚<li>æ•°æ®ä¸€æ—¦å­˜æ”¾åˆ° <code>Container</code>ï¼Œå°±ä¼šä¸€ç›´å¾…åœ¨é‚£å„¿ã€‚æˆ‘ä»¬<em>å¯ä»¥</em>ç”¨ <code>.__value</code> è·å–åˆ°æ•°æ®ï¼Œä½†è¿™æ ·åšæœ‰æ‚–åˆè¡·ã€‚</ul><p>å¦‚æœæŠŠå®¹å™¨æƒ³è±¡æˆç»ç’ƒç½çš„è¯ï¼Œä¸Šé¢è¿™ä¸‰æ¡é™ˆè¿°çš„ç†ç”±å°±ä¼šæ¯”è¾ƒæ¸…æ™°äº†ã€‚ä½†æ˜¯æš‚æ—¶ï¼Œè¯·å…ˆä¿æŒè€å¿ƒã€‚<h2 id=di-yi-ge-functor>ç¬¬ä¸€ä¸ª functor<a aria-label="Anchor link for: di-yi-ge-functor" class=zola-anchor href=#di-yi-ge-functor style=visibility:hidden>#</a></h2><p>ä¸€æ—¦å®¹å™¨é‡Œæœ‰äº†å€¼ï¼Œä¸ç®¡è¿™ä¸ªå€¼æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ç§æ–¹æ³•æ¥è®©åˆ«çš„å‡½æ•°èƒ½å¤Ÿæ“ä½œå®ƒã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> (a -> b) -> Container a -> Container b</span>
<span class="z-support z-class z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">f</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre><p>è¿™ä¸ª <code>map</code> è·Ÿæ•°ç»„é‚£ä¸ªè‘—åçš„ <code>map</code> ä¸€æ ·ï¼Œé™¤äº†å‰è€…çš„å‚æ•°æ˜¯ <code>Container a</code> è€Œåè€…æ˜¯ <code>[a]</code>ã€‚å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼ä¹Ÿå‡ ä¹ä¸€è‡´ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">2</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">two</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">two</span> <span class="z-keyword z-operator z-arithmetic z-ts">+</span> <span class="z-constant z-numeric z-decimal z-ts">2</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(4)</span>


<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>flamethrowers<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">s</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">s</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">toUpperCase</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container("FLAMETHROWERS")</span>


<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>bombs<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span> away<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>length<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(10)</span>
</span></code></pre><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™æ ·ä¸€ç§æ–¹æ³•ï¼Ÿå› ä¸ºæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸ç¦»å¼€ <code>Container</code> çš„æƒ…å†µä¸‹æ“ä½œå®¹å™¨é‡Œé¢çš„å€¼ã€‚è¿™æ˜¯éå¸¸äº†ä¸èµ·çš„ä¸€ä»¶äº‹æƒ…ã€‚<code>Container</code> é‡Œçš„å€¼ä¼ é€’ç»™ <code>map</code> å‡½æ•°ä¹‹åï¼Œå°±å¯ä»¥ä»»æˆ‘ä»¬æ“ä½œï¼›æ“ä½œç»“æŸåï¼Œä¸ºäº†é˜²æ­¢æ„å¤–å†æŠŠå®ƒæ”¾å›å®ƒæ‰€å±çš„ <code>Container</code>ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œæˆ‘ä»¬èƒ½è¿ç»­åœ°è°ƒç”¨ <code>map</code>ï¼Œè¿è¡Œä»»ä½•æˆ‘ä»¬æƒ³è¿è¡Œçš„å‡½æ•°ã€‚ç”šè‡³è¿˜å¯ä»¥æ”¹å˜å€¼çš„ç±»å‹ï¼Œå°±åƒä¸Šé¢æœ€åä¸€ä¸ªä¾‹å­ä¸­é‚£æ ·ã€‚<p>ç­‰ç­‰ï¼Œå¦‚æœæˆ‘ä»¬èƒ½ä¸€ç›´è°ƒç”¨ <code>map</code>ï¼Œé‚£å®ƒä¸å°±æ˜¯ä¸ªç»„åˆï¼ˆcompositionï¼‰ä¹ˆï¼è¿™é‡Œè¾¹æ˜¯æœ‰ä»€ä¹ˆæ•°å­¦é­”æ³•åœ¨èµ·ä½œç”¨ï¼Ÿæ˜¯ <em>functor</em>ã€‚å„ä½ï¼Œè¿™ä¸ªæ•°å­¦é­”æ³•å°±æ˜¯ <em>functor</em>ã€‚<blockquote><p>functor æ˜¯å®ç°äº† <code>map</code> å‡½æ•°å¹¶éµå®ˆä¸€äº›ç‰¹å®šè§„åˆ™çš„å®¹å™¨ç±»å‹ã€‚</blockquote><p>æ²¡é”™ï¼Œ<em>functor</em> å°±æ˜¯ä¸€ä¸ªç­¾äº†åˆçº¦çš„æ¥å£ã€‚æˆ‘ä»¬æœ¬æ¥å¯ä»¥ç®€å•åœ°æŠŠå®ƒç§°ä¸º <code>Mappable</code>ï¼Œä½†è¿™æ ·å°±æ²¡æœ‰ <em>fun</em>ï¼ˆè¯‘è€…æ³¨ï¼šæŒ‡ <code>functor</code> ä¸­åŒ…å« <code>fun</code> è¿™ä¸ªå•è¯ï¼Œæ˜¯ä¸€åŒå…³è¯­ï¼‰äº†ï¼Œå¯¹å§ï¼Ÿfunctor æ˜¯èŒƒç•´å­¦é‡Œçš„æ¦‚å¿µï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« æœ«å°¾è¯¦ç»†æ¢ç´¢ä¸æ­¤ç›¸å…³çš„æ•°å­¦çŸ¥è¯†ï¼›æš‚æ—¶æˆ‘ä»¬å…ˆç”¨è¿™ä¸ªåå­—å¾ˆå¥‡æ€ªçš„æ¥å£åšä¸€äº›ä¸é‚£ä¹ˆç†è®ºçš„ã€å®ç”¨æ€§çš„ç»ƒä¹ ã€‚<p>æŠŠå€¼è£…è¿›ä¸€ä¸ªå®¹å™¨ï¼Œè€Œä¸”åªèƒ½ä½¿ç”¨ <code>map</code> æ¥å¤„ç†å®ƒï¼Œè¿™ä¹ˆåšçš„ç†ç”±åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æ¢ç§æ–¹å¼æ¥é—®ï¼Œç­”æ¡ˆå°±å¾ˆæ˜æ˜¾äº†ï¼šè®©å®¹å™¨è‡ªå·±å»è¿ç”¨å‡½æ•°èƒ½ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„ï¼Ÿç­”æ¡ˆæ˜¯æŠ½è±¡ï¼Œå¯¹äºå‡½æ•°è¿ç”¨çš„æŠ½è±¡ã€‚å½“ <code>map</code> ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯·æ±‚å®¹å™¨æ¥è¿è¡Œè¿™ä¸ªå‡½æ•°ã€‚ä¸å¤¸å¼ åœ°è®²ï¼Œè¿™æ˜¯ä¸€ç§ååˆ†å¼ºå¤§çš„ç†å¿µã€‚<h2 id=xie-ding-e-de-maybe>è–›å®šè°”çš„ Maybe<a aria-label="Anchor link for: xie-ding-e-de-maybe" class=zola-anchor href=#xie-ding-e-de-maybe style=visibility:hidden>#</a></h2><figure><img alt="cool cat, need reference" src=https://shankun.github.io/img/cat.png></figure><p>è¯´å®è¯ <code>Container</code> æŒºæ— èŠçš„ï¼Œè€Œä¸”é€šå¸¸æˆ‘ä»¬ç§°å®ƒä¸º <code>Identity</code>ï¼Œä¸ <code>id</code> å‡½æ•°çš„ä½œç”¨ç›¸åŒï¼ˆè¿™é‡Œä¹Ÿæ˜¯æœ‰æ•°å­¦ä¸Šçš„è”ç³»çš„ï¼Œæˆ‘ä»¬ä¼šåœ¨é€‚å½“æ—¶å€™åŠ ä»¥è¯´æ˜ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§ functorï¼Œé‚£å°±æ˜¯å®ç°äº† <code>map</code> å‡½æ•°çš„ç±»ä¼¼å®¹å™¨çš„æ•°æ®ç±»å‹ï¼Œè¿™ç§ functor åœ¨è°ƒç”¨ <code>map</code> çš„æ—¶å€™èƒ½å¤Ÿæä¾›éå¸¸æœ‰ç”¨çš„è¡Œä¸ºã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„ functorã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">Maybe</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Maybe</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-support z-class z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">isNothing</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-comparison z-ts">===</span> <span class="z-constant z-language z-null z-ts">null</span> <span class="z-keyword z-operator z-logical z-ts">||</span> <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-comparison z-ts">===</span> <span class="z-constant z-language z-undefined z-ts">undefined</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-support z-class z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">isNothing</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">?</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-language z-null z-ts">null</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">f</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre><p><code>Maybe</code> çœ‹èµ·æ¥è·Ÿ <code>Container</code> éå¸¸ç±»ä¼¼ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹ä¸åŒï¼š<code>Maybe</code> ä¼šå…ˆæ£€æŸ¥è‡ªå·±çš„å€¼æ˜¯å¦ä¸ºç©ºï¼Œç„¶åæ‰è°ƒç”¨ä¼ è¿›æ¥çš„å‡½æ•°ã€‚è¿™æ ·æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>map</code> çš„æ—¶å€™å°±èƒ½é¿å…æ¼äººçš„ç©ºå€¼äº†ï¼ˆæ³¨æ„è¿™ä¸ªå®ç°å‡ºäºæ•™å­¦ç›®çš„åšäº†ç®€åŒ–ï¼‰ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Malkovich Malkovich<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">match</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-regexp z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">/</span>a<span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">ig</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Maybe(['a', 'a'])</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-language z-null z-ts">null</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">match</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-regexp z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">/</span>a<span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">ig</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Maybe(null)</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">name</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Boris<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>age<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">add</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">10</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Maybe(null)</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">name</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Dinah<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">age</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">14</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>age<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">add</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">10</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Maybe(24)</span>
</span></code></pre><p>æ³¨æ„çœ‹ï¼Œå½“ä¼ ç»™ <code>map</code> çš„å€¼æ˜¯ <code>null</code> æ—¶ï¼Œä»£ç å¹¶æ²¡æœ‰çˆ†å‡ºé”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸€æ¬¡ <code>Maybe</code> è¦è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆæ£€æŸ¥å®ƒè‡ªå·±çš„å€¼æ˜¯å¦ä¸ºç©ºã€‚<p>è¿™ç§ç‚¹è®°æ³•ï¼ˆdot notation syntaxï¼‰å·²ç»è¶³å¤Ÿå‡½æ•°å¼äº†ï¼Œä½†æ˜¯æ­£å¦‚åœ¨ç¬¬ 1 éƒ¨åˆ†æŒ‡å‡ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬æ›´æƒ³ä¿æŒä¸€ç§ pointfree çš„é£æ ¼ã€‚ç¢°å·§çš„æ˜¯ï¼Œ<code>map</code> å®Œå…¨æœ‰èƒ½åŠ›ä»¥ curry å‡½æ•°çš„æ–¹å¼æ¥â€œä»£ç†â€ä»»ä½• functorï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  map :: Functor f => (a -> b) -> f a -> f b</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">map</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">any_functor_at_all</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">any_functor_at_all</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åƒå¹³å¸¸ä¸€æ ·ä½¿ç”¨ç»„åˆï¼ŒåŒæ—¶ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ <code>map</code> äº†ï¼Œéå¸¸æŒ¯å¥‹äººå¿ƒã€‚ramda çš„ <code>map</code> ä¹Ÿæ˜¯è¿™æ ·ã€‚åé¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ç‚¹è®°æ³•æ›´æœ‰æ•™è‚²æ„ä¹‰çš„æ—¶å€™ä½¿ç”¨ç‚¹è®°æ³•ï¼Œåœ¨æ–¹ä¾¿ä½¿ç”¨ pointfree æ¨¡å¼çš„æ—¶å€™å°±ç”¨ pointfreeã€‚ä½ æ³¨æ„åˆ°äº†ä¹ˆï¼Ÿæˆ‘åœ¨ç±»å‹æ ‡ç­¾ä¸­å·å·å¼•å…¥äº†ä¸€ä¸ªé¢å¤–çš„æ ‡è®°ï¼š<code>Functor f =></code>ã€‚è¿™ä¸ªæ ‡è®°å‘Šè¯‰æˆ‘ä»¬ <code>f</code> å¿…é¡»æ˜¯ä¸€ä¸ª functorã€‚æ²¡ä»€ä¹ˆå¤æ‚çš„ï¼Œä½†æˆ‘è§‰å¾—æœ‰å¿…è¦æä¸€ä¸‹ã€‚<h2 id=yong-li>ç”¨ä¾‹<a aria-label="Anchor link for: yong-li" class=zola-anchor href=#yong-li style=visibility:hidden>#</a></h2><p>å®é™…å½“ä¸­ï¼Œ<code>Maybe</code> æœ€å¸¸ç”¨åœ¨é‚£äº›å¯èƒ½ä¼šæ— æ³•æˆåŠŸè¿”å›ç»“æœçš„å‡½æ•°ä¸­ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  safeHead :: [a] -> Maybe(a)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">safeHead</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">xs</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">xs</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-constant z-numeric z-decimal z-ts">0</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">streetName</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>street<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">safeHead</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>addresses<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">streetName</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">addresses</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe(null)</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">streetName</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">addresses</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">street</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Shady Ln.<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">number</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">4201</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe("Shady Ln.")</span>
</span></code></pre><p><code>safeHead</code> ä¸ä¸€èˆ¬çš„ <code>_.head</code> ç±»ä¼¼ï¼Œä½†æ˜¯å¢åŠ äº†ç±»å‹å®‰å…¨ä¿è¯ã€‚å¼•å…¥ <code>Maybe</code> ä¼šå‘ç”Ÿä¸€ä»¶éå¸¸æœ‰æ„æ€çš„äº‹æƒ…ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬è¢«è¿«è¦ä¸ç‹¡çŒ¾çš„ <code>null</code> æ‰“äº¤é“äº†ã€‚<code>safeHead</code> å‡½æ•°èƒ½å¤Ÿè¯šå®åœ°é¢„å‘Šå®ƒå¯èƒ½çš„å¤±è´¥â€”â€”å¤±è´¥çœŸæ²¡ä»€ä¹ˆå¯è€»çš„â€”â€”ç„¶åè¿”å›ä¸€ä¸ª <code>Maybe</code> æ¥é€šçŸ¥æˆ‘ä»¬ç›¸å…³ä¿¡æ¯ã€‚å®é™…ä¸Šä¸ä»…ä»…æ˜¯<em>é€šçŸ¥</em>ï¼Œå› ä¸ºæ¯•ç«Ÿæˆ‘ä»¬æƒ³è¦çš„å€¼æ·±è—åœ¨ <code>Maybe</code> å¯¹è±¡ä¸­ï¼Œè€Œä¸”åªèƒ½é€šè¿‡ <code>map</code> æ¥æ“ä½œå®ƒã€‚æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ç§ç”± <code>safeHead</code> å¼ºåˆ¶æ‰§è¡Œçš„ç©ºå€¼æ£€æŸ¥ã€‚æœ‰äº†è¿™ç§æ£€æŸ¥ï¼Œæˆ‘ä»¬æ‰èƒ½åœ¨å¤œé‡Œå®‰ç„¶å…¥ç¡ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“æœ€ä¸å—äººå¾…è§çš„ <code>null</code> ä¸ä¼šçªç„¶å‡ºç°ã€‚ç±»ä¼¼è¿™æ ·çš„ API èƒ½å¤ŸæŠŠä¸€ä¸ªåƒçº¸ç³Šèµ·æ¥çš„ã€è„†å¼±çš„åº”ç”¨å‡çº§ä¸ºå®å®åœ¨åœ¨çš„ã€å¥å£®çš„åº”ç”¨ï¼Œè¿™æ ·çš„ API ä¿è¯äº†æ›´åŠ å®‰å…¨çš„è½¯ä»¶ã€‚<p>æœ‰æ—¶å€™å‡½æ•°å¯ä»¥æ˜ç¡®è¿”å›ä¸€ä¸ª <code>Maybe(null)</code> æ¥è¡¨æ˜å¤±è´¥ï¼Œä¾‹å¦‚ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  withdraw :: Number -> Account -> Maybe(Account)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">withdraw</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">amount</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">account</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-object z-ts">account</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">balance</span> <span class="z-keyword z-operator z-relational z-ts">>=</span> <span class="z-variable z-other z-readwrite z-ts">amount</span> <span class="z-keyword z-operator z-ternary z-ts">?</span>
    <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">balance</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-variable z-other z-object z-ts">account</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">balance</span> <span class="z-keyword z-operator z-arithmetic z-ts">-</span> <span class="z-variable z-other z-readwrite z-ts">amount</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">:</span>
    <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-language z-null z-ts">null</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  finishTransaction :: Account -> String</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">finishTransaction</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">remainingBalance</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">updateLedger</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> &LT- å‡å®šè¿™ä¸¤ä¸ªå‡½æ•°å·²ç»åœ¨åˆ«å¤„å®šä¹‰å¥½äº†</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getTwenty :: Account -> Maybe(String)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">getTwenty</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">finishTransaction</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">withdraw</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">20</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>


<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getTwenty</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">balance</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">200<span class="z-meta z-delimiter z-decimal z-period z-ts">.</span>00</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe("Your balance is $180.00")</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getTwenty</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">balance</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">10<span class="z-meta z-delimiter z-decimal z-period z-ts">.</span>00</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe(null)</span>
</span></code></pre><p>è¦æ˜¯é’±ä¸å¤Ÿï¼Œ<code>withdraw</code> å°±ä¼šå¯¹æˆ‘ä»¬å—¤ä¹‹ä»¥é¼»ç„¶åè¿”å›ä¸€ä¸ª <code>Maybe(null)</code>ã€‚<code>withdraw</code> ä¹Ÿæ˜¾ç¤ºå‡ºäº†å®ƒçš„å¤šå˜æ€§ï¼Œä½¿å¾—æˆ‘ä»¬åç»­çš„æ“ä½œåªèƒ½ç”¨ <code>map</code> æ¥è¿›è¡Œã€‚è¿™ä¸ªä¾‹å­ä¸å‰é¢ä¾‹å­ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œè¿™é‡Œçš„ <code>null</code> æ˜¯æœ‰æ„çš„ã€‚æˆ‘ä»¬ä¸ç”¨ <code>Maybe(String)</code> ï¼Œè€Œæ˜¯ç”¨ <code>Maybe(null)</code> æ¥å‘é€å¤±è´¥çš„ä¿¡å·ï¼Œè¿™æ ·ç¨‹åºåœ¨æ”¶åˆ°ä¿¡å·åå°±èƒ½ç«‹åˆ»åœæ­¢æ‰§è¡Œã€‚è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼šå¦‚æœ <code>withdraw</code> å¤±è´¥äº†ï¼Œ<code>map</code> å°±ä¼šåˆ‡æ–­åç»­ä»£ç çš„æ‰§è¡Œï¼Œå› ä¸ºå®ƒæ ¹æœ¬å°±ä¸ä¼šè¿è¡Œä¼ é€’ç»™å®ƒçš„å‡½æ•°ï¼Œå³ <code>finishTransaction</code>ã€‚è¿™æ­£æ˜¯é¢„æœŸçš„æ•ˆæœï¼šå¦‚æœå–æ¬¾å¤±è´¥ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³æ›´æ–°æˆ–è€…æ˜¾ç¤ºè´¦æˆ·ä½™é¢ã€‚<h2 id=shi-fang-rong-qi-li-de-zhi>é‡Šæ”¾å®¹å™¨é‡Œçš„å€¼<a aria-label="Anchor link for: shi-fang-rong-qi-li-de-zhi" class=zola-anchor href=#shi-fang-rong-qi-li-de-zhi style=visibility:hidden>#</a></h2><p>äººä»¬ç»å¸¸å¿½ç•¥çš„ä¸€ä¸ªäº‹å®æ˜¯ï¼šä»»ä½•äº‹ç‰©éƒ½æœ‰ä¸ªæœ€ç»ˆå°½å¤´ã€‚é‚£äº›ä¼šäº§ç”Ÿä½œç”¨çš„å‡½æ•°ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å‘é€ JSON æ•°æ®ï¼Œè¿˜æ˜¯åœ¨å±å¹•ä¸Šæ‰“å°ä¸œè¥¿ï¼Œè¿˜æ˜¯æ›´æ”¹æ–‡ä»¶ç³»ç»Ÿï¼Œè¿˜æ˜¯åˆ«çš„ä»€ä¹ˆï¼Œéƒ½è¦æœ‰ä¸€ä¸ªç»“æŸã€‚ä½†æ˜¯æˆ‘ä»¬æ— æ³•é€šè¿‡ <code>return</code> æŠŠè¾“å‡ºä¼ é€’åˆ°å¤–éƒ¨ä¸–ç•Œï¼Œå¿…é¡»è¦è¿è¡Œè¿™æ ·æˆ–é‚£æ ·çš„å‡½æ•°æ‰èƒ½ä¼ é€’å‡ºå»ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œå¯ä»¥å€Ÿç”¨ç¦…å®—å…¬æ¡ˆçš„å£å»æ¥å™è¿°ï¼šâ€œå¦‚æœä¸€ä¸ªç¨‹åºè¿è¡Œä¹‹åæ²¡æœ‰å¯è§‚å¯Ÿåˆ°çš„ä½œç”¨ï¼Œé‚£å®ƒåˆ°åº•è¿è¡Œäº†æ²¡æœ‰ï¼Ÿâ€ã€‚æˆ–è€…ï¼Œè¿è¡Œä¹‹åè¾¾åˆ°è‡ªèº«çš„ç›®çš„äº†æ²¡æœ‰ï¼Ÿæœ‰å¯èƒ½å®ƒåªæ˜¯æµªè´¹äº†å‡ ä¸ª CPU å‘¨æœŸç„¶åå°±å»ç¡è§‰äº†...<p>åº”ç”¨ç¨‹åºæ‰€åšçš„å·¥ä½œå°±æ˜¯è·å–ã€æ›´æ”¹å’Œä¿å­˜æ•°æ®ç›´åˆ°ä¸å†éœ€è¦å®ƒä»¬ï¼Œå¯¹æ•°æ®åšè¿™äº›æ“ä½œçš„å‡½æ•°æœ‰å¯èƒ½è¢« <code>map</code> è°ƒç”¨ï¼Œè¿™æ ·çš„è¯æ•°æ®å°±å¯ä»¥ä¸ç”¨ç¦»å¼€å®ƒæ¸©æš–èˆ’é€‚çš„å®¹å™¨ã€‚è®½åˆºçš„æ˜¯ï¼Œæœ‰ä¸€ç§å¸¸è§çš„é”™è¯¯å°±æ˜¯è¯•å›¾ä»¥å„ç§æ–¹æ³•åˆ é™¤ <code>Maybe</code> é‡Œçš„å€¼ï¼Œå¥½åƒè¿™ä¸ªä¸ç¡®å®šçš„å€¼æ˜¯é­”é¬¼ï¼Œåˆ é™¤å®ƒå°±èƒ½è®©å®ƒçªç„¶æ˜¾å½¢ï¼Œç„¶åä¸€åˆ‡ç½ªæ¶éƒ½ä¼šå¾—åˆ°å®½æ•ä¼¼çš„ï¼ˆè¯‘è€…æ³¨ï¼šæ­¤å¤„åŸæ–‡åº”è¯¥æ˜¯æºè‡ªåœ£ç»ï¼‰ã€‚è¦çŸ¥é“ï¼Œæˆ‘ä»¬çš„å€¼æ²¡æœ‰å®Œæˆå®ƒçš„ä½¿å‘½ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯å…¶ä»–ä»£ç åˆ†æ”¯é€ æˆçš„ã€‚æˆ‘ä»¬çš„ä»£ç ï¼Œå°±åƒè–›å®šè°”çš„çŒ«ä¸€æ ·ï¼Œåœ¨æŸä¸ªç‰¹å®šçš„æ—¶é—´ç‚¹æœ‰ä¸¤ç§çŠ¶æ€ï¼Œè€Œä¸”åº”è¯¥ä¿æŒè¿™ç§çŠ¶å†µä¸å˜ç›´åˆ°æœ€åä¸€ä¸ªå‡½æ•°ä¸ºæ­¢ã€‚è¿™æ ·ï¼Œå“ªæ€•ä»£ç æœ‰å¾ˆå¤šé€»è¾‘æ€§çš„åˆ†æ”¯ï¼Œä¹Ÿèƒ½ä¿è¯ä¸€ç§çº¿æ€§çš„å·¥ä½œæµã€‚<p>ä¸è¿‡ï¼Œå¯¹å®¹å™¨é‡Œçš„å€¼æ¥è¯´ï¼Œè¿˜æ˜¯æœ‰ä¸ªé€ƒç”Ÿå£å¯ä»¥å‡ºå»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„å€¼ç„¶åè¿˜èƒ½ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç çš„è¯ï¼Œæ˜¯å¯ä»¥åšåˆ°çš„ï¼›è¦è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œå¯ä»¥å€ŸåŠ©ä¸€ä¸ªå¸®åŠ©å‡½æ•° <code>maybe</code>ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  maybe :: b -> (a -> b) -> Maybe a -> b</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">maybe</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">m</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">m</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">isNothing</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">?</span> <span class="z-variable z-other z-readwrite z-ts">x</span> <span class="z-keyword z-operator z-ternary z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">f</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">m</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getTwenty :: Account -> String</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">getTwenty</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span>
  <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">maybe</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>You're broke!<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">finishTransaction</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">withdraw</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">20</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>


<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getTwenty</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">balance</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">200<span class="z-meta z-delimiter z-decimal z-period z-ts">.</span>00</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> "Your balance is $180.00"</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getTwenty</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">balance</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">10<span class="z-meta z-delimiter z-decimal z-period z-ts">.</span>00</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> "You're broke!"</span>
</span></code></pre><p>è¿™æ ·å°±å¯ä»¥è¦ä¹ˆè¿”å›ä¸€ä¸ªé™æ€å€¼ï¼ˆä¸ <code>finishTransaction</code> è¿”å›å€¼çš„ç±»å‹ä¸€è‡´ï¼‰ï¼Œè¦ä¹ˆç»§ç»­æ„‰å¿«åœ°åœ¨æ²¡æœ‰ <code>Maybe</code> çš„æƒ…å†µä¸‹å®Œæˆäº¤æ˜“ã€‚<code>maybe</code> ä½¿æˆ‘ä»¬å¾—ä»¥é¿å…æ™®é€š <code>map</code> é‚£ç§å‘½ä»¤å¼çš„ <code>if/else</code> è¯­å¥ï¼š<code>if(x !== null) { return f(x) }</code>ã€‚<p>å¼•å…¥ <code>Maybe</code> å¯èƒ½ä¼šåœ¨åˆæœŸé€ æˆä¸€äº›ä¸é€‚ã€‚Swift å’Œ Scala ç”¨æˆ·çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆï¼Œå› ä¸ºè¿™ä¸¤é—¨è¯­è¨€çš„æ ¸å¿ƒåº“é‡Œå°±æœ‰ <code>Maybe</code> çš„æ¦‚å¿µï¼Œåªä¸è¿‡ä¼ªè£…æˆ <code>Option(al)</code> ç½¢äº†ã€‚è¢«è¿«åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½è¿›è¡Œç©ºå€¼æ£€æŸ¥ï¼ˆç”šè‡³æœ‰äº›æ—¶å€™æˆ‘ä»¬å¯ä»¥ç¡®å®šæŸä¸ªå€¼ä¸ä¼šä¸ºç©ºï¼‰ï¼Œçš„ç¡®è®©å¤§éƒ¨åˆ†äººå¤´ç–¼ä¸å·²ã€‚ç„¶è€Œéšç€æ—¶é—´æ¨ç§»ï¼Œç©ºå€¼æ£€æŸ¥ä¼šæˆä¸ºç¬¬äºŒæœ¬èƒ½ï¼Œè¯´ä¸å®šä½ è¿˜ä¼šæ„Ÿæ¿€å®ƒæä¾›çš„å®‰å…¨æ€§å‘¢ã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œç©ºå€¼æ£€æŸ¥å¤§å¤šæ•°æ—¶å€™éƒ½èƒ½é˜²æ­¢åœ¨ä»£ç é€»è¾‘ä¸Šå·å·¥å‡æ–™ï¼Œè®©æˆ‘ä»¬è„±ç¦»å±é™©ã€‚<p>ç¼–å†™ä¸å®‰å…¨çš„è½¯ä»¶å°±åƒç”¨èœ¡ç¬”å°å¿ƒç¿¼ç¿¼åœ°ç”»å½©è›‹ï¼Œç”»å®Œä¹‹åæŠŠå®ƒä»¬æ‰”åˆ°å¤§è¡—ä¸Šä¸€æ ·ï¼ˆè¯‘è€…æ³¨ï¼šæ„æ€æ˜¯å½©è›‹éå¸¸æ˜“äºå¯»æ‰¾ã€‚æ¥æºäºå¤æ´»èŠ‚ä¹ ä¿—ï¼Œäººä»¬ä¼šè—èµ·ä¸€äº›å½©è›‹è®©å­©å­å¯»æ‰¾ï¼‰ï¼Œæˆ–è€…åƒç”¨ä¸‰åªå°çŒªè­¦å‘Šè¿‡çš„ææ–™ç›–ä¸ªå…»è€é™¢ä¸€æ ·ï¼ˆè¯‘è€…æ³¨ï¼šæ¥æºäºâ€œä¸‰åªå°çŒªâ€ç«¥è¯æ•…äº‹ï¼‰ã€‚<code>Maybe</code> èƒ½å¤Ÿéå¸¸æœ‰æ•ˆåœ°å¸®åŠ©æˆ‘ä»¬å¢åŠ å‡½æ•°çš„å®‰å…¨æ€§ã€‚<p>æœ‰ä¸€ç‚¹æˆ‘å¿…é¡»è¦æåŠï¼Œå¦åˆ™å°±å¤ªä¸è´Ÿè´£ä»»äº†ï¼Œé‚£å°±æ˜¯ <code>Maybe</code> çš„â€œçœŸæ­£â€å®ç°ä¼šæŠŠå®ƒåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šä¸€ç§æ˜¯éç©ºå€¼ï¼Œå¦ä¸€ç§æ˜¯ç©ºå€¼ã€‚è¿™ç§å®ç°å…è®¸æˆ‘ä»¬éµå®ˆ <code>map</code> çš„ parametricity ç‰¹æ€§ï¼Œå› æ­¤ <code>null</code> å’Œ <code>undefined</code> èƒ½å¤Ÿä¾ç„¶è¢« <code>map</code> è°ƒç”¨ï¼Œfunctor é‡Œçš„å€¼æ‰€éœ€çš„é‚£ç§æ™®éæ€§æ¡ä»¶ä¹Ÿèƒ½å¾—åˆ°æ»¡è¶³ã€‚æ‰€ä»¥ä½ ä¼šç»å¸¸çœ‹åˆ° <code>Some(x) / None</code> æˆ–è€… <code>Just(x) / Nothing</code> è¿™æ ·çš„å®¹å™¨ç±»å‹åœ¨åšç©ºå€¼æ£€æŸ¥ï¼Œè€Œä¸æ˜¯ <code>Maybe</code>ã€‚<h2 id=chun-cuo-wu-chu-li>â€œçº¯â€é”™è¯¯å¤„ç†<a aria-label="Anchor link for: chun-cuo-wu-chu-li" class=zola-anchor href=#chun-cuo-wu-chu-li style=visibility:hidden>#</a></h2><figure><img alt="pick a hand... need a reference" src=https://shankun.github.io/img/fists.jpg></figure><p>è¯´å‡ºæ¥å¯èƒ½ä¼šè®©ä½ éœ‡æƒŠï¼Œ<code>throw/catch</code> å¹¶ä¸ååˆ†â€œçº¯â€ã€‚å½“ä¸€ä¸ªé”™è¯¯æŠ›å‡ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰æ”¶åˆ°è¿”å›å€¼ï¼Œåè€Œæ˜¯å¾—åˆ°äº†ä¸€ä¸ªè­¦å‘Šï¼æŠ›é”™çš„å‡½æ•°åå‡ºä¸€å¤§å †çš„ 0 å’Œ 1 ä½œä¸ºç›¾å’ŒçŸ›æ¥æ”»å‡»æˆ‘ä»¬ï¼Œç®€ç›´å°±åƒæ˜¯åœ¨åå‡»è¾“å…¥å€¼çš„å…¥ä¾µè€Œè¿›è¡Œçš„ä¸€åœºç”µå­å¤§ä½œæˆ˜ã€‚æœ‰äº† <code>Either</code> è¿™ä¸ªæ–°æœ‹å‹ï¼Œæˆ‘ä»¬å°±èƒ½ä»¥ä¸€ç§æ¯”å‘è¾“å…¥å€¼å®£æˆ˜å¥½å¾—å¤šçš„æ–¹å¼æ¥å¤„ç†é”™è¯¯ï¼Œé‚£å°±æ˜¯è¿”å›ä¸€æ¡éå¸¸ç¤¼è²Œçš„æ¶ˆæ¯ä½œä¸ºå›åº”ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">Left</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Left</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-support z-class z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">Right</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Right</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-support z-class z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">f</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre><p><code>Left</code> å’Œ <code>Right</code> æ˜¯æˆ‘ä»¬ç§°ä¹‹ä¸º <code>Either</code> çš„æŠ½è±¡ç±»å‹çš„ä¸¤ä¸ªå­ç±»ã€‚æˆ‘ç•¥å»äº†åˆ›å»º <code>Either</code> çˆ¶ç±»çš„ç¹æ–‡ç¼›èŠ‚ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä¼šç”¨åˆ°å®ƒçš„ï¼Œä½†ä½ äº†è§£ä¸€ä¸‹ä¹Ÿæ²¡åå¤„ã€‚æ³¨æ„çœ‹ï¼Œè¿™é‡Œé™¤äº†æœ‰ä¸¤ä¸ªç±»å‹ï¼Œæ²¡åˆ«çš„æ–°é²œä¸œè¥¿ã€‚æ¥çœ‹çœ‹å®ƒä»¬æ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>rain<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">str</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>b<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-readwrite z-ts">str</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Right("brain")</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>rain<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">str</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>b<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-readwrite z-ts">str</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Left("rain")</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">host</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>localhost<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">port</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">80</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>host<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Right('localhost')</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>rolls eyes...<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>host<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Left('rolls eyes...')</span>
</span></code></pre><p><code>Left</code> å°±åƒæ˜¯é’æ˜¥æœŸå°‘å¹´é‚£æ ·æ— è§†æˆ‘ä»¬è¦ <code>map</code> å®ƒçš„è¯·æ±‚ã€‚<code>Right</code> çš„ä½œç”¨å°±åƒæ˜¯ä¸€ä¸ª <code>Container</code>ï¼ˆä¹Ÿå°±æ˜¯ Identityï¼‰ã€‚è¿™é‡Œå¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼Œ<code>Left</code> æœ‰èƒ½åŠ›åœ¨å®ƒå†…éƒ¨åµŒå…¥ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚<p>å‡è®¾æœ‰ä¸€ä¸ªå¯èƒ½ä¼šå¤±è´¥çš„å‡½æ•°ï¼Œå°±æ‹¿æ ¹æ®ç”Ÿæ—¥è®¡ç®—å¹´é¾„æ¥è¯´å¥½äº†ã€‚çš„ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>Maybe(null)</code> æ¥è¡¨ç¤ºå¤±è´¥å¹¶æŠŠç¨‹åºå¼•å‘å¦ä¸€ä¸ªåˆ†æ”¯ï¼Œä½†æ˜¯è¿™å¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬å¤ªå¤šä¿¡æ¯ã€‚å¾ˆæœ‰å¯èƒ½æˆ‘ä»¬æƒ³çŸ¥é“å¤±è´¥çš„åŸå› æ˜¯ä»€ä¹ˆã€‚ç”¨ <code>Either</code> å†™ä¸€ä¸ªè¿™æ ·çš„ç¨‹åºçœ‹çœ‹ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">moment</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>moment<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getAge :: Date -> User -> Either(String, Number)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">getAge</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">now</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">user</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">birthdate</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">moment</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">user</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">birthdate</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>YYYY-MM-DD<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-keyword z-control z-conditional z-ts">if</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-keyword z-operator z-logical z-ts">!</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">birthdate</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">isValid</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Birth date could not be parsed<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">now</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">diff</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">birthdate</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>years<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getAge</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">moment</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>2005-12-12<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Right(9)</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getAge</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">moment</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>balloons!<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Left("Birth date could not be parsed")</span>
</span></code></pre><p>è¿™ä¹ˆä¸€æ¥ï¼Œå°±åƒ <code>Maybe(null)</code>ï¼Œå½“è¿”å›ä¸€ä¸ª <code>Left</code> çš„æ—¶å€™å°±ç›´æ¥è®©ç¨‹åºçŸ­è·¯ã€‚è·Ÿ <code>Maybe(null)</code> ä¸åŒçš„æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬å¯¹ç¨‹åºä¸ºä½•è„±ç¦»åŸå…ˆè½¨é“è‡³å°‘æœ‰äº†ä¸€ç‚¹å¤´ç»ªã€‚æœ‰ä¸€ä»¶äº‹è¦æ³¨æ„ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯ <code>Either(String, Number)</code>ï¼Œæ„å‘³ç€æˆ‘ä»¬è¿™ä¸ª <code>Either</code> å·¦è¾¹çš„å€¼æ˜¯ <code>String</code>ï¼Œå³è¾¹ï¼ˆè¯‘è€…æ³¨ï¼šä¹Ÿå°±æ˜¯æ­£ç¡®çš„å€¼ï¼‰çš„å€¼æ˜¯ <code>Number</code>ã€‚è¿™ä¸ªç±»å‹ç­¾åä¸æ˜¯å¾ˆæ­£å¼ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰å®šä¹‰ä¸€ä¸ªçœŸæ­£çš„ <code>Either</code> çˆ¶ç±»ï¼›ä½†æˆ‘ä»¬è¿˜æ˜¯ä»è¿™ä¸ªç±»å‹é‚£é‡Œäº†è§£åˆ°ä¸å°‘ä¸œè¥¿ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¾—åˆ°çš„è¦ä¹ˆæ˜¯ä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œè¦ä¹ˆå°±æ˜¯æ­£ç¡®çš„å¹´é¾„å€¼ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  fortune :: Number -> String</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">fortune</span></span>  </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>If you survive, you will be <span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">add</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">1</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  zoltar :: User -> Either(String, _)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">zoltar</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">fortune</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getAge</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">moment</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">zoltar</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>2005-12-12<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> "If you survive, you will be 10"</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Right(undefined)</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">zoltar</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>balloons!<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Left("Birth date could not be parsed")</span>
</span></code></pre><p>å¦‚æœ <code>birthdate</code> åˆæ³•ï¼Œè¿™ä¸ªç¨‹åºå°±ä¼šæŠŠå®ƒç¥ç§˜çš„å‘½è¿æ‰“å°åœ¨å±å¹•ä¸Šè®©æˆ‘ä»¬è§è¯ï¼›å¦‚æœä¸åˆæ³•ï¼Œæˆ‘ä»¬å°±ä¼šæ”¶åˆ°ä¸€ä¸ªæœ‰ç€æ¸…æ¸…æ¥šæ¥šçš„é”™è¯¯æ¶ˆæ¯çš„ <code>Left</code>ï¼Œå°½ç®¡è¿™ä¸ªæ¶ˆæ¯æ˜¯ç¨³ç¨³å½“å½“åœ°å¾…åœ¨å®ƒçš„å®¹å™¨é‡Œçš„ã€‚è¿™ç§è¡Œä¸ºå°±åƒï¼Œè™½ç„¶æˆ‘ä»¬åœ¨æŠ›é”™ï¼Œä½†æ˜¯æ˜¯ä»¥ä¸€ç§å¹³é™æ¸©å’Œçš„æ–¹å¼æŠ›é”™ï¼Œè€Œä¸æ˜¯åƒä¸€ä¸ªå°å­©å­é‚£æ ·ï¼Œæœ‰ä»€ä¹ˆä¸å¯¹åŠ²å°±é—¹è„¾æ°”å¤§å–Šå¤§å«ã€‚<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ ¹æ® <code>birthdate</code> çš„åˆæ³•æ€§æ¥æ§åˆ¶ä»£ç çš„é€»è¾‘åˆ†æ”¯ï¼ŒåŒæ—¶åˆè®©ä»£ç è¿›è¡Œä»å³åˆ°å·¦çš„ç›´çº¿è¿åŠ¨ï¼Œè€Œä¸ç”¨çˆ¬è¿‡å„ç§æ¡ä»¶è¯­å¥çš„å¤§æ‹¬å·ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¸ä¼šæŠŠ <code>console.log</code> æ”¾åˆ° <code>zoltar</code> å‡½æ•°é‡Œï¼Œè€Œæ˜¯åœ¨è°ƒç”¨ <code>zoltar</code> çš„æ—¶å€™æ‰ <code>map</code> å®ƒï¼Œä¸è¿‡æœ¬ä¾‹ä¸­ï¼Œè®©ä½ çœ‹çœ‹ <code>Right</code> åˆ†æ”¯å¦‚ä½•ä¸ <code>Left</code> ä¸åŒä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚æˆ‘ä»¬åœ¨ <code>Right</code> åˆ†æ”¯çš„ç±»å‹ç­¾åä¸­ä½¿ç”¨ <code>_</code> è¡¨ç¤ºä¸€ä¸ªåº”è¯¥å¿½ç•¥çš„å€¼ï¼ˆåœ¨æœ‰äº›æµè§ˆå™¨ä¸­ï¼Œä½ å¿…é¡»è¦ <code>console.log.bind(console)</code> æ‰èƒ½æŠŠ <code>console.log</code> å½“ä½œä¸€ç­‰å…¬æ°‘ä½¿ç”¨ï¼‰ã€‚<p>æˆ‘æƒ³å€Ÿæ­¤æœºä¼šæŒ‡å‡ºä¸€ä»¶ä½ å¯èƒ½æ²¡æ³¨æ„åˆ°çš„äº‹ï¼šè¿™ä¸ªä¾‹å­ä¸­ï¼Œå°½ç®¡ <code>fortune</code> ä½¿ç”¨äº† <code>Either</code>ï¼Œå®ƒå¯¹æ¯ä¸€ä¸ª functor åˆ°åº•è¦å¹²ä»€ä¹ˆå´æ˜¯æ¯«ä¸çŸ¥æƒ…çš„ã€‚å‰é¢ä¾‹å­ä¸­çš„ <code>finishTransaction</code> ä¹Ÿæ˜¯ä¸€æ ·ã€‚é€šä¿—ç‚¹æ¥è®²ï¼Œä¸€ä¸ªå‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœè¢« <code>map</code> åŒ…è£¹äº†ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šä»ä¸€ä¸ªé functor å‡½æ•°è½¬æ¢ä¸ºä¸€ä¸ª functor å‡½æ•°ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹å«åš <em>lift</em>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ™®é€šå‡½æ•°æ›´é€‚åˆæ“ä½œæ™®é€šçš„æ•°æ®ç±»å‹è€Œä¸æ˜¯å®¹å™¨ç±»å‹ï¼Œåœ¨å¿…è¦çš„æ—¶å€™å†é€šè¿‡ <em>lift</em> å˜ä¸ºåˆé€‚çš„å®¹å™¨å»æ“ä½œå®¹å™¨ç±»å‹ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯èƒ½å¾—åˆ°æ›´ç®€å•ã€é‡ç”¨æ€§æ›´é«˜çš„å‡½æ•°ï¼Œå®ƒä»¬èƒ½å¤Ÿéšéœ€æ±‚è€Œå˜ï¼Œå…¼å®¹ä»»æ„ functorã€‚<p><code>Either</code> å¹¶ä¸ä»…ä»…åªå¯¹åˆæ³•æ€§æ£€æŸ¥è¿™ç§ä¸€èˆ¬æ€§çš„é”™è¯¯ä½œç”¨éå‡¡ï¼Œå¯¹ä¸€äº›æ›´ä¸¥é‡çš„ã€èƒ½å¤Ÿä¸­æ–­ç¨‹åºæ‰§è¡Œçš„é”™è¯¯æ¯”å¦‚æ–‡ä»¶ä¸¢å¤±æˆ–è€… socket è¿æ¥æ–­å¼€ç­‰ï¼Œ<code>Either</code> åŒæ ·æ•ˆæœæ˜¾è‘—ã€‚ä½ å¯ä»¥è¯•è¯•æŠŠå‰é¢ä¾‹å­ä¸­çš„ <code>Maybe</code> æ›¿æ¢ä¸º <code>Either</code>ï¼Œçœ‹æ€ä¹ˆå¾—åˆ°æ›´å¥½çš„åé¦ˆã€‚<p>æ­¤åˆ»æˆ‘å¿ä¸ä½åœ¨æƒ³ï¼Œæˆ‘ä»…ä»…æ˜¯æŠŠ <code>Either</code> å½“ä½œä¸€ä¸ªé”™è¯¯æ¶ˆæ¯çš„å®¹å™¨ä»‹ç»ç»™ä½ ï¼è¿™æ ·çš„ä»‹ç»æœ‰å¤±åé¢‡ï¼Œå®ƒçš„èƒ½è€è¿œä¸æ­¢äºæ­¤ã€‚æ¯”å¦‚ï¼Œå®ƒè¡¨ç¤ºäº†é€»è¾‘æˆ–ï¼ˆä¹Ÿå°±æ˜¯ <code>||</code>ï¼‰ã€‚å†æ¯”å¦‚ï¼Œå®ƒä½“ç°äº†èŒƒç•´å­¦é‡Œ <em>coproduct</em> çš„æ¦‚å¿µï¼Œå½“ç„¶æœ¬ä¹¦ä¸ä¼šæ¶‰åŠè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œä½†å€¼å¾—ä½ å»æ·±å…¥äº†è§£ï¼Œå› ä¸ºè¿™ä¸ªæ¦‚å¿µæœ‰å¾ˆå¤šç‰¹æ€§å€¼å¾—åˆ©ç”¨ã€‚è¿˜æ¯”å¦‚ï¼Œå®ƒæ˜¯æ ‡å‡†çš„ sum typeï¼ˆæˆ–è€…å«ä¸äº¤å¹¶é›†ï¼Œdisjoint union of setsï¼‰ï¼Œå› ä¸ºå®ƒå«æœ‰çš„æ‰€æœ‰å¯èƒ½çš„å€¼çš„æ€»æ•°å°±æ˜¯å®ƒåŒ…å«çš„é‚£ä¸¤ç§ç±»å‹çš„æ€»æ•°ï¼ˆæˆ‘çŸ¥é“è¿™ä¹ˆè¯´ä½ å¬ä¸æ‡‚ï¼Œæ²¡å…³ç³»ï¼Œè¿™é‡Œæœ‰ä¸€ç¯‡<a rel="nofollow noreferrer" href=https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/sum-types>éå¸¸æ£’çš„æ–‡ç« </a>è®²è¿°è¿™ä¸ªé—®é¢˜ï¼‰ã€‚<code>Either</code> èƒ½åšçš„äº‹æƒ…å¤šç€å‘¢ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ª functorï¼Œæˆ‘ä»¬å°±ç”¨å®ƒå¤„ç†é”™è¯¯ã€‚<p>å°±åƒ <code>Maybe</code> å¯ä»¥æœ‰ä¸ª <code>maybe</code> ä¸€æ ·ï¼Œ<code>Either</code> ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ª <code>either</code>ã€‚ä¸¤è€…çš„ç”¨æ³•ç±»ä¼¼ï¼Œä½† <code>either</code> æ¥å—ä¸¤ä¸ªå‡½æ•°ï¼ˆè€Œä¸æ˜¯ä¸€ä¸ªï¼‰å’Œä¸€ä¸ªé™æ€å€¼ä¸ºå‚æ•°ã€‚è¿™ä¸¤ä¸ªå‡½æ•°çš„è¿”å›å€¼ç±»å‹ä¸€è‡´ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  either :: (a -> c) -> (b -> c) -> Either a b -> c</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">either</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">g</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">e</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-switch-statement z-expr z-ts"><span class="z-switch-expression z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">switch</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">e</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">constructor</span><span class="z-meta z-brace z-round z-ts">)</span></span> <span class="z-switch-block z-expr z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-variable z-other z-readwrite z-ts">Left</span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">f</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">e</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
    <span class="z-case-clause z-expr z-ts"><span class="z-keyword z-control z-switch z-ts">case</span> <span class="z-variable z-other z-readwrite z-ts">Right</span></span><span class="z-case-clause z-expr z-ts"><span class="z-punctuation z-definition z-section z-case-statement z-ts">:</span></span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">g</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">e</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  zoltar :: User -> _</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">zoltar</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">either</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">id</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">fortune</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getAge</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">moment</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">zoltar</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>2005-12-12<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> "If you survive, you will be 10"</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> undefined</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">zoltar</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">birthdate</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>balloons!<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> "Birth date could not be parsed"</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> undefined</span>
</span></code></pre><p>ç»ˆäºç”¨äº†ä¸€å›é‚£ä¸ªç¥ç§˜çš„ <code>id</code> å‡½æ•°ï¼å…¶å®å®ƒå°±æ˜¯ç®€å•åœ°å¤åˆ¶äº† <code>Left</code> é‡Œçš„é”™è¯¯æ¶ˆæ¯ï¼Œç„¶åæŠŠè¿™ä¸ªå€¼ä¼ ç»™ <code>console.log</code> è€Œå·²ã€‚é€šè¿‡å¼ºåˆ¶åœ¨ <code>getAge</code> å†…éƒ¨è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œæˆ‘ä»¬çš„ç®—å‘½ç¨‹åºæ›´åŠ å¥å£®äº†ã€‚ç»“æœå°±æ˜¯ï¼Œè¦ä¹ˆå‘Šè¯‰ç”¨æˆ·ä¸€ä¸ªæ®‹é…·çš„äº‹å®å¹¶åƒç®—å‘½å¸ˆé‚£æ ·è·Ÿä»–å‡»æŒï¼Œè¦ä¹ˆå°±ç»§ç»­è¿è¡Œç¨‹åºã€‚å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½å»å­¦ä¹ ä¸€ä¸ªå®Œå…¨ä¸åŒç±»å‹çš„ functor äº†ã€‚<h2 id=wang-lao-xian-sheng-you-zuo-yong>ç‹è€å…ˆç”Ÿæœ‰ä½œç”¨...<a aria-label="Anchor link for: wang-lao-xian-sheng-you-zuo-yong" class=zola-anchor href=#wang-lao-xian-sheng-you-zuo-yong style=visibility:hidden>#</a></h2><p>ï¼ˆè¯‘è€…æ³¨ï¼šåŸæ ‡é¢˜æ˜¯â€œOld McDonald had Effects...â€ï¼Œæºäºç¾å›½å„¿æ­Œâ€œOld McDonald Had a Farmâ€ã€‚ï¼‰<figure><img alt="dominoes.. need a reference" src=https://shankun.github.io/img/dominoes.jpg></figure><p>åœ¨å…³äºçº¯å‡½æ•°çš„çš„é‚£ä¸€ç« ï¼ˆå³ç¬¬ 3 ç« ï¼‰é‡Œï¼Œæœ‰ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„ä¾‹å­ã€‚è¿™ä¸ªä¾‹å­ä¸­çš„å‡½æ•°ä¼šäº§ç”Ÿå‰¯ä½œç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬é€šè¿‡æŠŠå®ƒåŒ…è£¹åœ¨å¦ä¸€ä¸ªå‡½æ•°é‡Œçš„æ–¹å¼æŠŠå®ƒå˜å¾—çœ‹èµ·æ¥åƒä¸€ä¸ªçº¯å‡½æ•°ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getFromStorage :: String -> (_ -> String)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">getFromStorage</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">key</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">localStorage</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-variable z-other z-readwrite z-ts">key</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>
</span></code></pre><p>è¦æ˜¯æˆ‘ä»¬æ²¡æŠŠ <code>getFromStorage</code> åŒ…åœ¨å¦ä¸€ä¸ªå‡½æ•°é‡Œï¼Œå®ƒçš„è¾“å‡ºå€¼å°±æ˜¯ä¸å®šçš„ï¼Œä¼šéšå¤–éƒ¨ç¯å¢ƒå˜åŒ–è€Œå˜åŒ–ã€‚æœ‰äº†è¿™ä¸ªç»“å®çš„åŒ…è£¹å‡½æ•°ï¼ˆwrapperï¼‰ï¼ŒåŒä¸€ä¸ªè¾“å…¥å°±æ€»èƒ½è¿”å›åŒä¸€ä¸ªè¾“å‡ºï¼šä¸€ä¸ªä» <code>localStorage</code> é‡Œå–å‡ºæŸä¸ªç‰¹å®šçš„å…ƒç´ çš„å‡½æ•°ã€‚å°±è¿™æ ·ï¼ˆä¹Ÿè®¸å†é«˜å”±å‡ å¥èµç¾åœ£æ¯çš„èµæ­Œï¼‰æˆ‘ä»¬æ´—æ¶¤äº†å¿ƒçµï¼Œä¸€åˆ‡éƒ½å¾—åˆ°äº†å®½æ•ã€‚<p>ç„¶è€Œï¼Œè¿™å¹¶æ²¡æœ‰å¤šå¤§çš„ç”¨å¤„ï¼Œä½ è¯´æ˜¯ä¸æ˜¯ã€‚å°±åƒæ˜¯ä½ æ”¶è—çš„å…¨æ–°æœªæ‹†å°çš„ç©å¶ï¼Œä¸èƒ½æ‹¿å‡ºæ¥ç©æœ‰ä»€ä¹ˆæ„æ€ã€‚æ‰€ä»¥è¦æ˜¯èƒ½æœ‰åŠæ³•è¿›åˆ°è¿™ä¸ªå®¹å™¨é‡Œé¢ï¼Œæ‹¿åˆ°å®ƒè—åœ¨é‚£å„¿çš„ä¸œè¥¿å°±å¥½äº†...åŠæ³•æ˜¯æœ‰çš„ï¼Œè¯·çœ‹ <code>IO</code>ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">IO</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-variable z-other z-constant z-object z-ts">IO</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-support z-class z-ts">IO</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">__value</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre><p><code>IO</code> è·Ÿä¹‹å‰çš„ functor ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œå®ƒçš„ <code>__value</code> æ€»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸è¿‡æˆ‘ä»¬ä¸æŠŠå®ƒå½“ä½œä¸€ä¸ªå‡½æ•°â€”â€”å®ç°çš„ç»†èŠ‚æˆ‘ä»¬æœ€å¥½å…ˆä¸ç®¡ã€‚è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…è·Ÿæˆ‘ä»¬åœ¨ <code>getFromStorage</code> é‚£é‡Œçœ‹åˆ°çš„ä¸€æ¨¡ä¸€æ ·ï¼š<code>IO</code> æŠŠéçº¯æ‰§è¡ŒåŠ¨ä½œï¼ˆimpure actionï¼‰æ•è·åˆ°åŒ…è£¹å‡½æ•°é‡Œï¼Œç›®çš„æ˜¯å»¶è¿Ÿæ‰§è¡Œè¿™ä¸ªéçº¯åŠ¨ä½œã€‚å°±è¿™ä¸€ç‚¹è€Œè¨€ï¼Œæˆ‘ä»¬è®¤ä¸º <code>IO</code> åŒ…å«çš„æ˜¯è¢«åŒ…è£¹çš„æ‰§è¡ŒåŠ¨ä½œçš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯åŒ…è£¹å‡½æ•°æœ¬èº«ã€‚è¿™åœ¨ <code>of</code> å‡½æ•°é‡Œå¾ˆæ˜æ˜¾ï¼š<code>IO(function(){ return x })</code> ä»…ä»…æ˜¯ä¸ºäº†å»¶è¿Ÿæ‰§è¡Œï¼Œå…¶å®æˆ‘ä»¬å¾—åˆ°çš„æ˜¯ <code>IO(x)</code>ã€‚<p>æ¥ç”¨ç”¨çœ‹ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  io_window_ :: IO Window</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">io_window</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">io_window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">win</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-object z-ts">win</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">innerWidth</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> IO(1430)</span>

<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">io_window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>location<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>href<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>/<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> IO(["http:", "", "localhost:8000", "blog", "posts"])</span>


<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  $ :: String -> IO [DOM]</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">$</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">selector</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-variable z-dom z-ts">document</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-dom z-ts">querySelectorAll</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">selector</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">$</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>#myDiv<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">head</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">div</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-object z-ts">div</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">innerHTML</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> IO('I am some inner html')</span>
</span></code></pre><p>è¿™é‡Œï¼Œ<code>io_window</code> æ˜¯ä¸€ä¸ªçœŸæ­£çš„ <code>IO</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹å®ƒä½¿ç”¨ <code>map</code>ã€‚è‡³äº <code>$</code>ï¼Œåˆ™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨åä¼šè¿”å›ä¸€ä¸ª <code>IO</code>ã€‚æˆ‘æŠŠè¿™é‡Œçš„è¿”å›å€¼éƒ½å†™æˆäº†<em>æ¦‚å¿µæ€§</em>çš„ï¼Œè¿™æ ·å°±æ›´åŠ ç›´è§‚ï¼›ä¸è¿‡å®é™…çš„è¿”å›å€¼æ˜¯ <code>{ __value: [Function] }</code>ã€‚å½“è°ƒç”¨ <code>IO</code> çš„ <code>map</code> çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠä¼ è¿›æ¥çš„å‡½æ•°æ”¾åœ¨äº† <code>map</code> å‡½æ•°é‡Œçš„ç»„åˆçš„æœ€æœ«ç«¯ï¼ˆä¹Ÿå°±æ˜¯æœ€å·¦è¾¹ï¼‰ï¼Œåè¿‡æ¥è¿™ä¸ªå‡½æ•°å°±æˆä¸ºäº†æ–°çš„ <code>IO</code> çš„æ–° <code>__value</code>ï¼Œå¹¶ç»§ç»­ä¸‹å»ã€‚ä¼ ç»™ <code>map</code> çš„å‡½æ•°å¹¶æ²¡æœ‰è¿è¡Œï¼Œæˆ‘ä»¬åªæ˜¯æŠŠå®ƒä»¬å‹åˆ°ä¸€ä¸ªâ€œè¿è¡Œæ ˆâ€çš„æœ€æœ«ç«¯è€Œå·²ï¼Œä¸€ä¸ªå‡½æ•°ç´§æŒ¨ç€å¦ä¸€ä¸ªå‡½æ•°ï¼Œå°±åƒå°å¿ƒæ‘†æ”¾çš„å¤šç±³è¯ºéª¨ç‰Œä¸€æ ·ï¼Œè®©äººä¸æ•¢è½»æ˜“æ¨å€’ã€‚è¿™ç§æƒ…å½¢å¾ˆå®¹æ˜“å«äººè”æƒ³èµ·â€œå››äººå¸®â€ï¼ˆè¯‘è€…æ³¨ï¼šã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä½œè€…ï¼‰æå‡ºçš„å‘½ä»¤æ¨¡å¼ï¼ˆcommand patternï¼‰æˆ–è€…é˜Ÿåˆ—ï¼ˆqueueï¼‰ã€‚<p>èŠ±ç‚¹æ—¶é—´æ‰¾å›ä½ å…³äº functor çš„ç›´è§‰å§ã€‚æŠŠå®ç°ç»†èŠ‚æ”¾åœ¨ä¸€è¾¹ä¸ç®¡ï¼Œä½ åº”è¯¥å°±èƒ½è‡ªç„¶è€Œç„¶åœ°å¯¹å„ç§å„æ ·çš„å®¹å™¨ä½¿ç”¨ <code>map</code> äº†ï¼Œä¸ç®¡å®ƒæ˜¯å¤šä¹ˆå¥‡ç‰¹æ€ªå¼‚ã€‚è¿™ç§ä¼ªè¶…è‡ªç„¶çš„åŠ›é‡è¦å½’åŠŸäº functor çš„å®šå¾‹ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« æœ«å°¾å¯¹æ­¤ä½œä¸€ç•ªæ¢ç´¢ã€‚æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥åœ¨ä¸ç‰ºç‰²ä»£ç çº¯ç²¹æ€§çš„æƒ…å†µä¸‹ï¼Œéšæ„ä½¿ç”¨è¿™äº›ä¸çº¯çš„å€¼äº†ã€‚<p>å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»æŠŠé‡å…½å…³è¿›äº†ç¬¼å­ã€‚ä½†æ˜¯ï¼Œåœ¨æŸä¸€æ—¶åˆ»è¿˜æ˜¯è¦æŠŠå®ƒæ”¾å‡ºæ¥ã€‚å› ä¸ºå¯¹ <code>IO</code> è°ƒç”¨ <code>map</code> å·²ç»ç§¯ç´¯äº†å¤ªå¤šä¸çº¯çš„æ“ä½œï¼Œæœ€åå†è¿è¡Œå®ƒæ— ç–‘ä¼šæ‰“ç ´å¹³é™ã€‚é—®é¢˜æ˜¯åœ¨å“ªé‡Œï¼Œä»€ä¹ˆæ—¶å€™æ‰“å¼€ç¬¼å­çš„å¼€å…³ï¼Ÿè€Œä¸”æœ‰æ²¡æœ‰å¯èƒ½æˆ‘ä»¬åªè¿è¡Œ <code>IO</code> å´ä¸è®©ä¸çº¯çš„æ“ä½œå¼„è„åŒæ‰‹ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œåªè¦æŠŠè´£ä»»æ¨åˆ°è°ƒç”¨è€…èº«ä¸Šå°±è¡Œäº†ã€‚æˆ‘ä»¬çš„çº¯ä»£ç ï¼Œå°½ç®¡é˜´é™©ç‹¡è¯ˆè¯¡è®¡å¤šç«¯ï¼Œä½†æ˜¯å´å§‹ç»ˆä¿æŒä¸€å‰¯æ¸…ç™½æ— è¾œçš„æ¨¡æ ·ï¼Œåè€Œæ˜¯å®é™…è¿è¡Œ <code>IO</code> å¹¶äº§ç”Ÿäº†ä½œç”¨çš„è°ƒç”¨è€…ï¼ŒèƒŒäº†é»‘é”…ã€‚æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts">
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">//// çº¯ä»£ç åº“: lib/params.js ///////</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  url :: IO String</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">url</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">location</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">href</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  toPairs =  String -> [[String]]</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">toPairs</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>=<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>&<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  params :: String -> [[String]]</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">params</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">toPairs</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">last</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>?<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  findParam :: String -> IO Maybe [String]</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">findParam</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">key</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">of</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">filter</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">eq</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">key</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">head</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">params</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">url</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">//// éçº¯è°ƒç”¨ä»£ç : main.js ///////</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> è°ƒç”¨ __value() æ¥è¿è¡Œå®ƒï¼</span>
<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">findParam</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>searchTerm<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">__value</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe(['searchTerm', 'wafflehouse'])</span>
</span></code></pre><p>lib/params.js æŠŠ <code>url</code> åŒ…è£¹åœ¨ä¸€ä¸ª <code>IO</code> é‡Œï¼Œç„¶åæŠŠè¿™å¤´é‡å…½ä¼ ç»™äº†è°ƒç”¨è€…ï¼›ä¸€åŒæ‰‹ä¿æŒçš„éå¸¸å¹²å‡€ã€‚ä½ å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬æŠŠå®¹å™¨ä¹Ÿâ€œå‹æ ˆâ€äº†ï¼Œè¦çŸ¥é“åˆ›å»ºä¸€ä¸ª <code>IO(Maybe([x]))</code> æ²¡æœ‰ä»»ä½•ä¸åˆç†çš„åœ°æ–¹ã€‚æˆ‘ä»¬è¿™ä¸ªâ€œæ ˆâ€æœ‰ä¸‰å±‚ functorï¼ˆ<code>Array</code> æ˜¯æœ€æœ‰èµ„æ ¼æˆä¸º mappable çš„å®¹å™¨ç±»å‹ï¼‰ï¼Œä»¤äººå°è±¡æ·±åˆ»ã€‚<p>æœ‰ä»¶äº‹å›°æ‰°æˆ‘å¾ˆä¹…äº†ï¼Œç°åœ¨æˆ‘å¿…é¡»å¾—è¯´å‡ºæ¥ï¼š<code>IO</code> çš„ <code>__value</code> å¹¶ä¸æ˜¯å®ƒåŒ…å«çš„å€¼ï¼Œä¹Ÿä¸æ˜¯åƒä¸¤ä¸ªä¸‹åˆ’çº¿æš—ç¤ºé‚£æ ·æ˜¯ä¸€ä¸ªç§æœ‰å±æ€§ã€‚<code>__value</code> æ˜¯æ‰‹æ¦´å¼¹çš„å¼¹æ “ï¼Œåªåº”è¯¥è¢«è°ƒç”¨è€…ä»¥æœ€å…¬å¼€çš„æ–¹å¼æ‹‰åŠ¨ã€‚ä¸ºäº†æé†’ç”¨æˆ·å®ƒçš„å˜åŒ–æ— å¸¸ï¼Œæˆ‘ä»¬æŠŠå®ƒé‡å‘½åä¸º <code>unsafePerformIO</code> çœ‹çœ‹ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">IO</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">unsafePerformIO</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-support z-class z-ts">IO</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">unsafePerformIO</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre><p>çœ‹ï¼Œè¿™å°±å¥½å¤šäº†ã€‚ç°åœ¨è°ƒç”¨çš„ä»£ç å°±å˜æˆäº† <code>findParam("searchTerm").unsafePerformIO()</code>ï¼Œå¯¹åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ï¼ˆä»¥åŠæœ¬ä¹¦è¯»è€…ï¼‰æ¥è¯´ï¼Œè¿™ç®€ç›´å°±ç›´ç™½å¾—ä¸èƒ½å†ç›´ç™½äº†ã€‚<p><code>IO</code> ä¼šæˆä¸ºä¸€ä¸ªå¿ è¯šçš„ä¼´ä¾£ï¼Œå¸®åŠ©æˆ‘ä»¬é©¯åŒ–é‚£äº›ç‹‚é‡çš„éçº¯æ“ä½œã€‚ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†å­¦ä¹ ä¸€ç§è·Ÿ <code>IO</code> åœ¨ç²¾ç¥ä¸Šç›¸ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸Šåˆåƒå·®ä¸‡åˆ«çš„ç±»å‹ã€‚<h2 id=yi-bu-ren-wu>å¼‚æ­¥ä»»åŠ¡<a aria-label="Anchor link for: yi-bu-ren-wu" class=zola-anchor href=#yi-bu-ren-wu style=visibility:hidden>#</a></h2><p>å›è°ƒï¼ˆcallbackï¼‰æ˜¯é€šå¾€åœ°ç‹±çš„ç‹­çª„çš„èºæ—‹é˜¶æ¢¯ã€‚å®ƒä»¬æ˜¯åŸƒèˆå°”ï¼ˆè¯‘è€…æ³¨ï¼šè·å…°ç‰ˆç”»è‰ºæœ¯å®¶ï¼‰è®¾è®¡çš„æ§åˆ¶æµã€‚çœ‹åˆ°ä¸€ä¸ªä¸ªåµŒå¥—çš„å›è°ƒæŒ¤åœ¨å¤§å°æ‹¬å·æ­æˆçš„æ¶å­ä¸Šï¼Œè®©äººä¸ç”±è‡ªä¸»åœ°è”æƒ³åˆ°åœ°ç‰¢é‡Œçš„çµè–„ç‹±ï¼ˆè¿˜èƒ½å†ä½ç‚¹ä¹ˆï¼ï¼‰ï¼ˆè¯‘è€…æ³¨ï¼šçµè–„ç‹±å³ limboï¼ŒåŸºç£æ•™ä¸­åœ°ç‹±è¾¹ç¼˜ä¹‹æ„ï¼‰ã€‚å…‰æ˜¯æƒ³åˆ°è¿™æ ·çš„å›è°ƒå°±è®©æˆ‘å¹½é—­ææ€–ç—‡å‘ä½œäº†ã€‚ä¸è¿‡åˆ«æ‹…å¿ƒï¼Œå¤„ç†å¼‚æ­¥ä»£ç ï¼Œæˆ‘ä»¬æœ‰ä¸€ç§æ›´å¥½çš„æ–¹å¼ï¼Œå®ƒçš„åå­—ä»¥â€œFâ€å¼€å¤´ã€‚<p>è¿™ç§æ–¹å¼çš„å†…éƒ¨æœºåˆ¶è¿‡äºå¤æ‚ï¼Œå¤æ‚å¾—å“ªæ€•æˆ‘å”¾æ²«æ¨ªé£ä¹Ÿå¾ˆéš¾è®²æ¸…æ¥šã€‚æ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥ç”¨ Quildreen Motta çš„ <a rel="nofollow noreferrer" href=https://folktale.origamitower.com/>Folktale</a> é‡Œçš„ <code>Data.Task</code> ï¼ˆä¹‹å‰æ˜¯ <code>Data.Future</code>ï¼‰ã€‚æ¥è§è¯ä¸€äº›ä¾‹å­å§ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Node readfile example:</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=======================</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">fs</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>fs<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  readFile :: String -> Task(Error, JSON)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">readFile</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">filename</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Task</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">reject</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">result</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">fs</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">readFile</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">filename</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>utf-8<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">err</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">data</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
      <span class="z-variable z-other z-readwrite z-ts">err</span> <span class="z-keyword z-operator z-ternary z-ts">?</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">reject</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">err</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">result</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">data</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
    <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">readFile</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>metamorphosis<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span><span class="z-constant z-character z-escape z-ts">\n</span><span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">head</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Task("One morning, as Gregor Samsa was waking up from anxious dreams, he discovered that</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> in bed he had been changed into a monstrous verminous bug.")</span>


<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> jQuery getJSON example:</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">========================</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getJSON :: String -> {} -> Task(Error, JSON)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">getJSON</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">url</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">params</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Task</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">reject</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">result</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">$</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">getJSON</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">url</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">params</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">result</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">fail</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">reject</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getJSON</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>/video<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">id</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">10</span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>title<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Task("Family Matters ep 15")</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä¼ å…¥æ™®é€šçš„å®é™…å€¼ä¹Ÿæ²¡é—®é¢˜</span>
<span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Task</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">3</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">three</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">three</span> <span class="z-keyword z-operator z-arithmetic z-ts">+</span> <span class="z-constant z-numeric z-decimal z-ts">1</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Task(4)</span>
</span></code></pre><p>ä¾‹å­ä¸­çš„ <code>reject</code> å’Œ <code>result</code> å‡½æ•°åˆ†åˆ«æ˜¯å¤±è´¥å’ŒæˆåŠŸçš„å›è°ƒã€‚æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°è°ƒç”¨ <code>Task</code> çš„ <code>map</code> å‡½æ•°ï¼Œå°±èƒ½æ“ä½œå°†æ¥çš„å€¼ï¼Œå¥½åƒè¿™ä¸ªå€¼å°±åœ¨é‚£å„¿ä¼¼çš„ã€‚åˆ°ç°åœ¨ <code>map</code> å¯¹ä½ æ¥è¯´åº”è¯¥ä¸ç¨€å¥‡äº†ã€‚<p>å¦‚æœç†Ÿæ‚‰ promise çš„è¯ï¼Œä½ è¯¥èƒ½è®¤å‡ºæ¥ <code>map</code> å°±æ˜¯ <code>then</code>ï¼Œ<code>Task</code> å°±æ˜¯ä¸€ä¸ª promiseã€‚å¦‚æœä¸ç†Ÿæ‚‰ä½ ä¹Ÿä¸å¿…æ°”é¦ï¼Œåæ­£æˆ‘ä»¬ä¹Ÿä¸ä¼šç”¨å®ƒï¼Œå› ä¸ºå®ƒå¹¶ä¸çº¯ï¼›ä½†åˆšæ‰çš„ç±»æ¯”è¿˜æ˜¯æˆç«‹çš„ã€‚<p>ä¸ <code>IO</code> ç±»ä¼¼ï¼Œ<code>Task</code> åœ¨æˆ‘ä»¬ç»™å®ƒç»¿ç¯ä¹‹å‰æ˜¯ä¸ä¼šè¿è¡Œçš„ã€‚äº‹å®ä¸Šï¼Œæ­£å› ä¸ºå®ƒè¦ç­‰æˆ‘ä»¬çš„å‘½ä»¤ï¼Œ<code>IO</code> å®é™…å°±è¢«çº³å…¥åˆ°äº† <code>Task</code> åä¸‹ï¼Œä»£è¡¨æ‰€æœ‰çš„å¼‚æ­¥æ“ä½œâ€”â€”<code>readFile</code> å’Œ <code>getJSON</code> å¹¶ä¸éœ€è¦ä¸€ä¸ªé¢å¤–çš„ <code>IO</code> å®¹å™¨æ¥å˜çº¯ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå½“æˆ‘ä»¬è°ƒç”¨å®ƒçš„ <code>map</code> çš„æ—¶å€™ï¼Œ<code>Task</code> å·¥ä½œçš„æ–¹å¼ä¸ <code>IO</code> å‡ æ— å·®åˆ«ï¼šéƒ½æ˜¯æŠŠå¯¹æœªæ¥çš„æ“ä½œçš„æŒ‡ç¤ºæ”¾åœ¨ä¸€ä¸ªæ—¶é—´èƒ¶å›Šé‡Œï¼Œå°±åƒå®¶åŠ¡åˆ—è¡¨ï¼ˆchore chartï¼‰é‚£æ ·â€”â€”çœŸæ˜¯ä¸€ç§ç²¾å¯†çš„æ‹–å»¶æœ¯ã€‚<p>æˆ‘ä»¬å¿…é¡»è°ƒç”¨ <code>fork</code> æ–¹æ³•æ‰èƒ½è¿è¡Œ <code>Task</code>ï¼Œè¿™ç§æœºåˆ¶ä¸ <code>unsafePerformIO</code> ç±»ä¼¼ã€‚ä½†ä¹Ÿæœ‰ä¸åŒï¼Œä¸åŒä¹‹å¤„å°±åƒ <code>fork</code> è¿™ä¸ªåç§°è¡¨æ˜çš„é‚£æ ·ï¼Œå®ƒä¼š fork ä¸€ä¸ªå­è¿›ç¨‹è¿è¡Œå®ƒæ¥æ”¶åˆ°çš„å‚æ•°ä»£ç ï¼Œå…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œä¸å—å½±å“ï¼Œä¸»çº¿ç¨‹ä¹Ÿä¸ä¼šé˜»å¡ã€‚å½“ç„¶è¿™ç§æ•ˆæœä¹Ÿå¯ä»¥ç”¨å…¶ä»–ä¸€äº›æŠ€æœ¯æ¯”å¦‚çº¿ç¨‹å®ç°ï¼Œä½†è¿™é‡Œçš„è¿™ç§æ–¹æ³•å·¥ä½œèµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªæ™®é€šçš„å¼‚æ­¥è°ƒç”¨ï¼Œè€Œä¸” event loop èƒ½å¤Ÿä¸å—å½±å“åœ°ç»§ç»­è¿è½¬ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>fork</code>ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Pure application</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=====================</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> blogTemplate :: String</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  blogPage :: Posts -> HTML</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">blogPage</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Handlebars</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">compile</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">blogTemplate</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  renderPage :: Posts -> HTML</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">renderPage</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">blogPage</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">sortBy</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>date<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  blog :: Params -> Task(Error, HTML)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">blog</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">renderPage</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getJSON</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>/posts<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>


<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Impure calling code</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=====================</span>
<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">blog</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">fork</span></span><span class="z-meta z-brace z-round z-ts">(</span>
  <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">error</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">$</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>#error<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">html</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">error</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">message</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
  <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">page</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">$</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>#main<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">html</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">page</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
<span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">$</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>#spinner<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">show</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>è°ƒç”¨ <code>fork</code> ä¹‹åï¼Œ<code>Task</code> å°±èµ¶ç´§è·‘å»æ‰¾ä¸€äº›æ–‡ç« ï¼Œæ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨é¡µé¢ä¸Šå±•ç¤ºä¸€ä¸ª spinnerï¼Œå› ä¸º <code>fork</code> ä¸ä¼šç­‰æ”¶åˆ°å“åº”äº†æ‰æ‰§è¡Œå®ƒåé¢çš„ä»£ç ã€‚æœ€åï¼Œæˆ‘ä»¬è¦ä¹ˆæŠŠæ–‡ç« å±•ç¤ºåœ¨é¡µé¢ä¸Šï¼Œè¦ä¹ˆå°±æ˜¾ç¤ºä¸€ä¸ªå‡ºé”™ä¿¡æ¯ï¼Œè§† <code>getJSON</code> è¯·æ±‚æ˜¯å¦æˆåŠŸè€Œå®šã€‚<p>èŠ±ç‚¹æ—¶é—´æ€è€ƒä¸‹è¿™é‡Œçš„æ§åˆ¶æµä¸ºä½•æ˜¯çº¿æ€§çš„ã€‚æˆ‘ä»¬åªéœ€è¦ä»ä¸‹è¯»åˆ°ä¸Šï¼Œä»å³è¯»åˆ°å·¦å°±èƒ½ç†è§£ä»£ç ï¼Œå³ä¾¿è¿™æ®µç¨‹åºå®é™…ä¸Šä¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ°å¤„è·³æ¥è·³å»ã€‚è¿™ç§æ–¹å¼ä½¿å¾—é˜…è¯»å’Œç†è§£åº”ç”¨ç¨‹åºçš„ä»£ç æ¯”é‚£ç§è¦åœ¨å„ç§å›è°ƒå’Œé”™è¯¯å¤„ç†ä»£ç å—ä¹‹é—´è·³è·ƒçš„æ–¹å¼å®¹æ˜“å¾—å¤šã€‚<p>å¤©å“ªï¼Œä½ çœ‹åˆ°äº†ä¹ˆï¼Œ<code>Task</code> å±…ç„¶ä¹ŸåŒ…å«äº† <code>Either</code>ï¼æ²¡åŠæ³•ï¼Œä¸ºäº†èƒ½å¤„ç†å°†æ¥å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œå®ƒå¿…é¡»å¾—è¿™ä¹ˆåšï¼Œå› ä¸ºæ™®é€šçš„æ§åˆ¶æµåœ¨å¼‚æ­¥çš„ä¸–ç•Œé‡Œä¸é€‚ç”¨ã€‚è¿™è‡ªç„¶æ˜¯å¥½äº‹ä¸€æ¡©ï¼Œå› ä¸ºå®ƒå¤©ç„¶åœ°æä¾›äº†å……åˆ†çš„â€œçº¯â€é”™è¯¯å¤„ç†ã€‚<p>å°±ç®—æ˜¯æœ‰äº† <code>Task</code>ï¼Œ<code>IO</code> å’Œ <code>Either</code> è¿™ä¸¤ä¸ª functor ä¹Ÿç…§æ ·èƒ½æ´¾ä¸Šç”¨åœºã€‚å¾…æˆ‘ä¸¾ä¸ªç®€å•ä¾‹å­å‘ä½ è¯´æ˜ä¸€ç§æ›´å¤æ‚ã€æ›´å‡æƒ³çš„æƒ…å†µï¼Œè™½ç„¶å¦‚æ­¤ï¼Œè¿™ä¸ªä¾‹å­è¿˜æ˜¯èƒ½å¤Ÿè¯´æ˜æˆ‘çš„ç›®çš„ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Postgres.connect :: Url -> IO DbConnection</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> runQuery :: DbConnection -> ResultSet</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> readFile :: String -> Task Error String</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Pure application</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=====================</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  dbUrl :: Config -> Either Error Url</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">dbUrl</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">c</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">uname</span> <span class="z-keyword z-operator z-logical z-ts">&&</span> <span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">pass</span> <span class="z-keyword z-operator z-logical z-ts">&&</span> <span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">host</span> <span class="z-keyword z-operator z-logical z-ts">&&</span> <span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">db</span><span class="z-meta z-brace z-round z-ts">)</span>
    <span class="z-keyword z-operator z-ternary z-ts">?</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>db:pg://<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">uname</span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>:<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">pass</span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>@<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-dom z-ts">host</span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>5432/<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-keyword z-operator z-arithmetic z-ts">+</span><span class="z-variable z-other z-object z-ts">c</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">db</span><span class="z-meta z-brace z-round z-ts">)</span>
    <span class="z-keyword z-operator z-ternary z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-support z-class z-error z-ts">Error</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Invalid config!<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  connectDb :: Config -> Either Error (IO DbConnection)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">connectDb</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">Postgres</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">connect</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">dbUrl</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  getConfig :: Filename -> Task Error (Either Error (IO DbConnection))</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">getConfig</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">connectDB</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-support z-constant z-json z-ts">JSON</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-json z-ts">parse</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">readFile</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>


<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Impure calling code</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=====================</span>
<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">getConfig</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>db.json<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">fork</span></span><span class="z-meta z-brace z-round z-ts">(</span>
  <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">logErr</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>couldn't read file<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">either</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">runQuery</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ <code>readFile</code> æˆåŠŸçš„é‚£ä¸ªä»£ç åˆ†æ”¯é‡Œåˆ©ç”¨äº† <code>Either</code> å’Œ <code>IO</code>ã€‚<code>Task</code> å¤„ç†å¼‚æ­¥è¯»å–æ–‡ä»¶è¿™ä¸€æ“ä½œå½“ä¸­çš„ä¸â€œçº¯â€æ€§ï¼Œä½†æ˜¯éªŒè¯ config çš„åˆæ³•æ€§ä»¥åŠè¿æ¥æ•°æ®åº“åˆ™åˆ†åˆ«ä½¿ç”¨äº† <code>Either</code> å’Œ <code>IO</code>ã€‚æ‰€ä»¥ä½ çœ‹ï¼Œæˆ‘ä»¬ä¾ç„¶åœ¨åŒæ­¥åœ°è·Ÿæ‰€æœ‰äº‹ç‰©æ‰“äº¤é“ã€‚<p>ä¾‹å­æˆ‘è¿˜å¯ä»¥å†ä¸¾ä¸€äº›ï¼Œä½†æ˜¯å°±åˆ°æ­¤ä¸ºæ­¢å§ã€‚è¿™äº›æ¦‚å¿µå°±åƒ <code>map</code> ä¸€æ ·ç®€å•ã€‚<p>å®é™…å½“ä¸­ï¼Œä½ å¾ˆæœ‰å¯èƒ½åœ¨ä¸€ä¸ªå·¥ä½œæµä¸­è·‘å¥½å‡ ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œæ•´å­¦ä¹ å®¹å™¨çš„ api æ¥åº”å¯¹è¿™ç§æƒ…å†µã€‚ä¸å¿…æ‹…å¿ƒï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šå»å­¦ä¹  monad ä¹‹ç±»çš„æ¦‚å¿µã€‚ä¸è¿‡ï¼Œåœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆæ£€æŸ¥ä¸‹æ‰€æœ‰è¿™äº›èƒŒåçš„æ•°å­¦çŸ¥è¯†ã€‚<h2 id=yi-dian-li-lun>ä¸€ç‚¹ç†è®º<a aria-label="Anchor link for: yi-dian-li-lun" class=zola-anchor href=#yi-dian-li-lun style=visibility:hidden>#</a></h2><p>å‰é¢æåˆ°ï¼Œfunctor çš„æ¦‚å¿µæ¥è‡ªäºèŒƒç•´å­¦ï¼Œå¹¶æ»¡è¶³ä¸€äº›å®šå¾‹ã€‚æˆ‘ä»¬å…ˆæ¥æ¢ç´¢è¿™äº›å®ç”¨çš„å®šå¾‹ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> identity</span>
<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">id</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-comparison z-ts">===</span> <span class="z-variable z-other z-readwrite z-ts">id</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> composition</span>
<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">g</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-comparison z-ts">===</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">g</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p><em>åŒä¸€å¾‹</em>å¾ˆç®€å•ï¼Œä½†æ˜¯ä¹Ÿå¾ˆé‡è¦ã€‚å› ä¸ºè¿™äº›å®šå¾‹éƒ½æ˜¯å¯è¿è¡Œçš„ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨æˆ‘ä»¬è‡ªå·±çš„ functor ä¸Šè¯•éªŒå®ƒä»¬ï¼ŒéªŒè¯å®ƒä»¬æ˜¯å¦æˆç«‹ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">idLaw1</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">id</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">idLaw2</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">id</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">idLaw1</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">2</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(2)</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">idLaw2</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-constant z-numeric z-decimal z-ts">2</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container(2)</span>
</span></code></pre><p>çœ‹åˆ°æ²¡ï¼Œå®ƒä»¬æ˜¯ç›¸ç­‰çš„ã€‚æ¥ä¸‹æ¥çœ‹ä¸€çœ‹ç»„åˆã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">compLaw1</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span> world<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span> cruel<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">compLaw2</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span> world<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span> cruel<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compLaw1</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Goodbye<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container('Goodbye cruel world')</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compLaw2</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Container</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Goodbye<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">=> Container('Goodbye cruel world')</span>
</span></code></pre><p>åœ¨èŒƒç•´å­¦ä¸­ï¼Œfunctor æ¥å—ä¸€ä¸ªèŒƒç•´çš„å¯¹è±¡å’Œæ€å°„ï¼ˆmorphismï¼‰ï¼Œç„¶åæŠŠå®ƒä»¬æ˜ å°„ï¼ˆmapï¼‰åˆ°å¦ä¸€ä¸ªèŒƒç•´é‡Œå»ã€‚æ ¹æ®å®šä¹‰ï¼Œè¿™ä¸ªæ–°èŒƒç•´ä¸€å®šä¼šæœ‰ä¸€ä¸ªå•ä½å…ƒï¼ˆidentityï¼‰ï¼Œä¹Ÿä¸€å®šèƒ½å¤Ÿç»„åˆæ€å°„ï¼›æˆ‘ä»¬æ— é¡»éªŒè¯è¿™ä¸€ç‚¹ï¼Œå‰é¢æåˆ°çš„å®šå¾‹ä¿è¯è¿™äº›ä¸œè¥¿ä¼šåœ¨æ˜ å°„åå¾—åˆ°ä¿ç•™ã€‚<p>å¯èƒ½æˆ‘ä»¬å…³äºèŒƒç•´çš„å®šä¹‰è¿˜æ˜¯æœ‰ç‚¹æ¨¡ç³Šã€‚ä½ å¯ä»¥æŠŠèŒƒç•´æƒ³è±¡æˆä¸€ä¸ªæœ‰ç€å¤šä¸ªå¯¹è±¡çš„ç½‘ç»œï¼Œå¯¹è±¡ä¹‹é—´é æ€å°„è¿æ¥ã€‚é‚£ä¹ˆ functor å¯ä»¥æŠŠä¸€ä¸ªèŒƒç•´æ˜ å°„åˆ°å¦å¤–ä¸€ä¸ªï¼Œè€Œä¸”ä¸ä¼šç ´ååŸæœ‰çš„ç½‘ç»œã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ <code>a</code> å±äºæºèŒƒç•´ <code>C</code>ï¼Œé‚£ä¹ˆé€šè¿‡ functor <code>F</code> æŠŠ <code>a</code> æ˜ å°„åˆ°ç›®æ ‡èŒƒç•´ <code>D</code> ä¸Šä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>F a</code> æ¥æŒ‡ä»£ <code>a</code> å¯¹è±¡ï¼ˆæŠŠè¿™äº›å­—æ¯æ‹¼èµ·æ¥æ˜¯ä»€ä¹ˆï¼Ÿï¼ï¼‰ã€‚å¯èƒ½çœ‹å›¾ä¼šæ›´å®¹æ˜“ç†è§£ï¼š<figure><img alt="Categories mapped" src=https://shankun.github.io/img/catmap.png></figure><p>æ¯”å¦‚ï¼Œ<code>Maybe</code> å°±æŠŠç±»å‹å’Œå‡½æ•°çš„èŒƒç•´æ˜ å°„åˆ°è¿™æ ·ä¸€ä¸ªèŒƒç•´ï¼šå³æ¯ä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½ä¸å­˜åœ¨ï¼Œæ¯ä¸ªæ€å°„éƒ½æœ‰ç©ºå€¼æ£€æŸ¥çš„èŒƒç•´ã€‚è¿™ä¸ªç»“æœåœ¨ä»£ç ä¸­çš„å®ç°æ–¹å¼æ˜¯ç”¨ <code>map</code> åŒ…è£¹æ¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨ functor åŒ…è£¹æ¯ä¸€ä¸ªç±»å‹ã€‚è¿™æ ·å°±èƒ½ä¿è¯æ¯ä¸ªæ™®é€šçš„ç±»å‹å’Œå‡½æ•°éƒ½èƒ½åœ¨æ–°ç¯å¢ƒä¸‹ç»§ç»­ä½¿ç”¨ç»„åˆã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œä»£ç ä¸­çš„ functor å®é™…ä¸Šæ˜¯æŠŠèŒƒç•´æ˜ å°„åˆ°äº†ä¸€ä¸ªåŒ…å«ç±»å‹å’Œå‡½æ•°çš„å­èŒƒç•´ï¼ˆsub categoryï¼‰ä¸Šï¼Œä½¿å¾—è¿™äº› functor æˆä¸ºäº†ä¸€ç§æ–°çš„ç‰¹æ®Šçš„ endofunctorã€‚ä½†å‡ºäºæœ¬ä¹¦çš„ç›®çš„ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ªä¸åŒçš„èŒƒç•´ã€‚<p>å¯ä»¥ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºè¿™ç§æ€å°„åŠå…¶å¯¹è±¡çš„æ˜ å°„ï¼š<figure><img alt="functor diagram" src=https://shankun.github.io/img/functormap.png></figure><p>è¿™å¼ å›¾é™¤äº†èƒ½è¡¨ç¤ºæ€å°„å€ŸåŠ© functor <code>F</code> å®Œæˆä»ä¸€ä¸ªèŒƒç•´åˆ°å¦ä¸€ä¸ªèŒƒç•´çš„æ˜ å°„ä¹‹å¤–ï¼Œæˆ‘ä»¬å‘ç°å®ƒè¿˜ç¬¦åˆäº¤æ¢å¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé¡ºç€ç®­å¤´çš„æ–¹å‘å¾€å‰ï¼Œå½¢æˆçš„æ¯ä¸€ä¸ªè·¯å¾„éƒ½æŒ‡å‘åŒä¸€ä¸ªç»“æœã€‚ä¸åŒçš„è·¯å¾„æ„å‘³ç€ä¸åŒçš„è¡Œä¸ºï¼Œä½†æœ€ç»ˆéƒ½ä¼šå¾—åˆ°åŒä¸€ä¸ªæ•°æ®ç±»å‹ã€‚è¿™ç§å½¢å¼åŒ–ç»™äº†æˆ‘ä»¬åŸåˆ™æ€§çš„æ–¹å¼å»æ€è€ƒä»£ç â€”â€”æ— é¡»åˆ†æå’Œè¯„ä¼°æ¯ä¸€ä¸ªå•ç‹¬çš„åœºæ™¯ï¼Œåªç®¡å¯ä»¥å¤§èƒ†åœ°åº”ç”¨å…¬å¼å³å¯ã€‚æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  topRoute :: String -> Maybe(String)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">topRoute</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">of</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">reverse</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">  bottomRoute :: String -> Maybe(String)</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">bottomRoute</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">reverse</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">of</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>


<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">topRoute</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>hi<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe("ih")</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">bottomRoute</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>hi<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Maybe("ih")</span>
</span></code></pre><p>æˆ–è€…çœ‹å›¾ï¼š<figure><img alt="functor diagram 2" src=https://shankun.github.io/img/functormapmaybe.png></figure><p>æ ¹æ®æ‰€æœ‰ functor éƒ½æœ‰çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³ç†è§£ä»£ç ï¼Œé‡æ„ä»£ç ã€‚<p>functor ä¹Ÿèƒ½åµŒå¥—ä½¿ç”¨ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">nested</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Task</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>pillows<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>no sleep for you<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">toUpperCase</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">nested</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Task([Right("PILLOWS"), Left("no sleep for you")])</span>
</span></code></pre><p><code>nested</code> æ˜¯ä¸€ä¸ªå°†æ¥çš„æ•°ç»„ï¼Œæ•°ç»„çš„å…ƒç´ æœ‰å¯èƒ½æ˜¯ç¨‹åºæŠ›å‡ºçš„é”™è¯¯ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>map</code> å‰¥å¼€æ¯ä¸€å±‚çš„åµŒå¥—ï¼Œç„¶åå¯¹æ•°ç»„çš„å…ƒç´ è°ƒç”¨ä¼ é€’è¿›å»çš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸­é—´æ²¡æœ‰å›è°ƒã€<code>if/else</code> è¯­å¥å’Œ <code>for</code> å¾ªç¯ï¼Œåªæœ‰ä¸€ä¸ªæ˜ç¡®çš„ä¸Šä¸‹æ–‡ã€‚çš„ç¡®ï¼Œæˆ‘ä»¬å¿…é¡»è¦ <code>map(map(map(f)))</code> æ‰èƒ½æœ€ç»ˆè¿è¡Œå‡½æ•°ã€‚ä¸æƒ³è¿™ä¹ˆåšçš„è¯ï¼Œå¯ä»¥ç»„åˆ functorã€‚æ˜¯çš„ï¼Œä½ æ²¡å¬é”™ï¼š<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">Compose</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f_g_x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">getCompose</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">f_g_x</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-support z-class z-ts">Compose</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-ts">prototype</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">map</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">f</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Compose</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">f</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-language z-this z-ts">this</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">getCompose</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">tmd</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Task</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Rock over London<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ctmd</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Compose</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">tmd</span><span class="z-meta z-brace z-round z-ts">)</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">map</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">concat</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>, rock on, Chicago<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">ctmd</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Compose(Task(Maybe("Rock over London, rock on, Chicago")))</span>

<span class="z-variable z-other z-object z-ts">ctmd</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">getCompose</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Task(Maybe("Rock over London, rock on, Chicago"))</span>
</span></code></pre><p>çœ‹ï¼Œåªæœ‰ä¸€ä¸ª <code>map</code>ã€‚functor ç»„åˆæ˜¯ç¬¦åˆç»“åˆå¾‹çš„ï¼Œè€Œä¸”ä¹‹å‰æˆ‘ä»¬å®šä¹‰çš„ <code>Container</code> å®é™…ä¸Šæ˜¯ä¸€ä¸ªå« <code>Identity</code> çš„ functorã€‚identity å’Œå¯ç»“åˆçš„ç»„åˆä¹Ÿèƒ½äº§ç”Ÿä¸€ä¸ªèŒƒç•´ï¼Œè¿™ä¸ªç‰¹æ®Šçš„èŒƒç•´çš„å¯¹è±¡æ˜¯å…¶ä»–èŒƒç•´ï¼Œæ€å°„æ˜¯ functorã€‚è¿™å®åœ¨å¤ªä¼¤è„‘ç­‹äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šæ·±å…¥è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯èµå¹ä¸€ä¸‹è¿™ç§æ¨¡å¼çš„ç»“æ„æ€§å«ä¹‰ï¼Œæˆ–è€…å®ƒçš„ç®€å•çš„æŠ½è±¡ä¹‹ç¾ä¹Ÿæ˜¯å¥½çš„ã€‚<h2 id=zong-jie>æ€»ç»“<a aria-label="Anchor link for: zong-jie" class=zola-anchor href=#zong-jie style=visibility:hidden>#</a></h2><p>æˆ‘ä»¬å·²ç»è®¤è¯†äº†å‡ ä¸ªä¸åŒçš„ functorï¼Œä½†å®ƒä»¬çš„æ•°é‡å…¶å®æ˜¯æ— é™çš„ã€‚æœ‰ä¸€äº›å€¼å¾—æ³¨æ„çš„å¯è¿­ä»£æ•°æ®ç±»å‹ï¼ˆiterable data structureï¼‰æˆ‘ä»¬æ²¡æœ‰ä»‹ç»ï¼Œåƒ treeã€listã€map å’Œ pair ç­‰ï¼Œä»¥åŠæ‰€æœ‰ä½ èƒ½è¯´å‡ºæ¥çš„ã€‚eventstream å’Œ observable ä¹Ÿéƒ½æ˜¯ functorã€‚å…¶ä»–çš„ functor å¯èƒ½å°±æ˜¯æ‹¿æ¥åšå°è£…æˆ–è€…ä»…ä»…æ˜¯æ¨¡æ‹Ÿç±»å‹ã€‚æˆ‘ä»¬èº«è¾¹åˆ°å¤„éƒ½æœ‰ functor çš„èº«å½±ï¼Œæœ¬ä¹¦ä¹Ÿå°†ä¼šå¤§é‡ä½¿ç”¨å®ƒä»¬ã€‚<p>ç”¨å¤šä¸ª functor å‚æ•°è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ€ä¹ˆæ ·å‘¢ï¼Ÿå¤„ç†ä¸€ä¸ªç”±ä¸çº¯çš„æˆ–è€…å¼‚æ­¥çš„æ“ä½œç»„æˆçš„æœ‰åºåºåˆ—æ€ä¹ˆæ ·å‘¢ï¼Ÿè¦åº”å¯¹è¿™ä¸ªä»€ä¹ˆéƒ½è£…åœ¨ç›’å­é‡Œçš„ä¸–ç•Œï¼Œç›®å‰æˆ‘ä»¬å·¥å…·ç®±é‡Œçš„å·¥å…·è¿˜ä¸å…¨ã€‚ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†ç›´å¥” monad è€Œå»ã€‚<p><a href=../mostly-adequate-guide-ch9/>ç¬¬ 9 ç« : Monad</a><h2 id=lian-xi>ç»ƒä¹ <a aria-label="Anchor link for: lian-xi" class=zola-anchor href=#lian-xi style=visibility:hidden>#</a></h2><pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>../../support<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">Task</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>data.task<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">_</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>ramda<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  1</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä½¿ç”¨ _.add(x,y) å’Œ _.map(f,x) åˆ›å»ºä¸€ä¸ªèƒ½è®© functor é‡Œçš„å€¼å¢åŠ çš„å‡½æ•°</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex1</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts">ç»ƒä¹  2</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä½¿ç”¨ _.head è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">xs</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Identity</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>do<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>ray<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>me<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>fa<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>so<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>la<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>ti<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>do<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex2</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  3</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä½¿ç”¨ safeProp å’Œ _.head æ‰¾åˆ° user çš„åå­—çš„é¦–å­—æ¯</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">safeProp</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">curry</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">o</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Maybe</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">o</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-variable z-other z-readwrite z-ts">x</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">user</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">id</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-numeric z-decimal z-ts">2</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">name</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Albert<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span> </span><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex3</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>


<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  4</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä½¿ç”¨ Maybe é‡å†™ ex4ï¼Œä¸è¦æœ‰ if è¯­å¥</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">ex4</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">n</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-conditional z-ts">if</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">n</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span> <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">parseInt</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">n</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span> <span class="z-punctuation z-definition z-block z-ts">}</span></span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex4</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  5</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> å†™ä¸€ä¸ªå‡½æ•°ï¼Œå…ˆ getPost è·å–ä¸€ç¯‡æ–‡ç« ï¼Œç„¶å toUpperCase è®©è¿™ç‰‡æ–‡ç« æ ‡é¢˜å˜ä¸ºå¤§å†™</span>

<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> getPost :: Int -> Future({id: Int, title: String})</span>
<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">getPost</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">i</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">Task</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">rej</span><span class="z-punctuation z-separator z-parameter z-ts">,</span> <span class="z-variable z-parameter z-ts">res</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">setTimeout</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
      <span class="z-meta z-function-call z-ts"><span class="z-entity z-name z-function z-ts">res</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">id</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-variable z-other z-readwrite z-ts">i</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">title</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>Love them futures<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span></span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span>
    <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-constant z-numeric z-decimal z-ts">300</span><span class="z-meta z-brace z-round z-ts">)</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex5</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  6</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ checkActive() å’Œ showWelcome() åˆ†åˆ«å…è®¸è®¿é—®æˆ–è¿”å›é”™è¯¯</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">showWelcome</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">compose</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-dom z-ts">add</span></span><span class="z-meta z-brace z-round z-ts">(</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>Welcome <span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">_</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">prop</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>name<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-brace z-round z-ts">)</span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">checkActive</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">user</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
 <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-object z-ts">user</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">active</span> <span class="z-keyword z-operator z-ternary z-ts">?</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Right</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">user</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-ternary z-ts">:</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">Left</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">of</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>Your account is not active<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-meta z-brace z-round z-ts">)</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex6</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  7</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> å†™ä¸€ä¸ªéªŒè¯å‡½æ•°ï¼Œæ£€æŸ¥å‚æ•°æ˜¯å¦ length > 3ã€‚å¦‚æœæ˜¯å°±è¿”å› Right(x)ï¼Œå¦åˆ™å°±è¿”å›</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Left("You need > 3")</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">ex7</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-constant z-language z-undefined z-ts">undefined</span> <span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> &LT--- write me. (don't be pointfree)</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>



<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ç»ƒä¹  8</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ==========</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> ä½¿ç”¨ç»ƒä¹  7 çš„ ex7 å’Œ Either æ„é€ ä¸€ä¸ª functorï¼Œå¦‚æœä¸€ä¸ª user åˆæ³•å°±ä¿å­˜å®ƒï¼Œå¦åˆ™</span>
<span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> è¿”å›é”™è¯¯æ¶ˆæ¯ã€‚åˆ«å¿˜äº† either çš„ä¸¤ä¸ªå‚æ•°å¿…é¡»è¿”å›åŒä¸€ç±»å‹çš„æ•°æ®ã€‚</span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-entity z-name z-function z-ts">save</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">x</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">IO</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-function z-expression z-ts"><span class="z-storage z-type z-function z-ts">function</span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
    <span class="z-meta z-function-call z-ts"><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>SAVED USER!<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
    <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-variable z-other z-readwrite z-ts">x</span> <span class="z-keyword z-operator z-arithmetic z-ts">+</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">'</span>-saved<span class="z-punctuation z-definition z-string z-end z-ts">'</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
<span class="z-punctuation z-definition z-block z-ts">}</span></span></span></span>

<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">var</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">ex8</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-constant z-language z-undefined z-ts">undefined</span></span>
</span></code></pre></article><div class=giscus></div><script async crossorigin data-category=Announcements data-category-id=DIC_kwDOKg3Pks4CacrE data-emit-metadata=0 data-input-position=top data-lang=zh-CN data-loading=lazy data-mapping=pathname data-reactions-enabled=1 data-repo=shankun/shankun.github.io data-repo-id=R_kgDOKg3Pkg data-strict=0 data-theme=light src=https://giscus.app/client.js></script></div><footer><div class=copyright><p>Â© 2025 ShanKun</div><div class=credits>powered by <a rel="noreferrer noopener" href=https://www.getzola.org target=_blank>zola</a> and <a rel="noreferrer noopener" href=https://github.com/isunjn/serene target=_blank>serene</a></div></footer></main></div><script src=https://shankun.github.io/js/lightense.min.js></script><script src=https://shankun.github.io/js/main.js></script>